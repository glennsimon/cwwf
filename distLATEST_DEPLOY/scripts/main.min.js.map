{"version":3,"sources":["screenfull.js","dialog-polyfill.js","main.js","signin.js","games.js","router.js"],"names":["document","window","isCommonjs","module","exports","keyboardAllowed","Element","fn","val","fnMap","i","l","length","ret","eventNameMap","change","fullscreenchange","error","fullscreenerror","screenfull","request","elem","requestFullscreen","documentElement","test","navigator","userAgent","ALLOW_KEYBOARD_INPUT","exit","exitFullscreen","toggle","isFullscreen","onchange","callback","on","onerror","event","eventName","addEventListener","off","removeEventListener","raw","Object","defineProperties","get","Boolean","fullscreenElement","element","enumerable","enabled","fullscreenEnabled","supportCustomEvent","CustomEvent","x","ev","createEvent","initCustomEvent","bubbles","cancelable","detail","prototype","Event","createsStackingContext","el","body","s","getComputedStyle","invalid","k","ok","undefined","opacity","position","webkitOverflowScrolling","parentElement","findNearestDialog","localName","safeBlur","blur","inNodeList","nodeList","node","isFormMethodDialog","hasAttribute","getAttribute","toLowerCase","dialogPolyfillInfo","dialog","dialog_","replacedStyleTop_","openAsModal_","setAttribute","show","bind","showModal","close","returnValue","mo","MutationObserver","maybeHideModal","observe","attributes","attributeFilter","removed","cb","downgradeModal","timeout","delayModel","target","cand","type","substr","clearTimeout","setTimeout","forEach","name","defineProperty","set","setOpen","backdrop_","createElement","className","backdropClick_","contains","style","zIndex","top","parentNode","removeChild","dialogPolyfill","dm","removeDialog","value","removeAttribute","e","fake","insertBefore","firstChild","tabIndex","focus","redirectedEvent","initMouseEvent","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","dispatchEvent","stopPropagation","focus_","querySelector","opts","query","map","push","join","activeElement","updateZIndex","dialogZ","backdropZ","Error","open","pushDialog","console","warn","needsCentering","reposition","nextSibling","opt_returnValue","closeEvent","scrollTop","topValue","innerHeight","offsetHeight","Math","max","isInlinePositionSetByStylesheet","styleSheets","styleSheet","cssRules","j","rule","selectedNodes","querySelectorAll","selectorText","cssTop","getPropertyValue","cssBottom","computedStyle","bottom","forceRegisterDialog","HTMLDialogElement","registerDialog","DialogManager","pendingDialogStack","checkDOM","checkDOM_","overlay","forwardTab_","handleKey_","handleFocus_","zIndexLow_","zIndexHigh_","mo_","records","rec","c","removedNodes","concat","blockDocument","childList","subtree","unblockDocument","disconnect","updateStacking","dpi","last","p","appendChild","containedByTopDialog_","candidate","preventDefault","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","keyCode","cancelEvent","clone","slice","indexOf","allowed","unshift","index","splice","formSubmitter","useValue","replacementFormSubmit","nativeFormSubmit","call","testForm","method","methodDescriptor","getOwnPropertyDescriptor","HTMLFormElement","realGet","realSet","v","defaultPrevented","form","valid","offsetX","offsetY","submit","define","puzzleWorker","isLocalhost","location","hostname","match","protocol","serviceWorker","register","then","registration","onupdatefound","controller","installingWorker","installing","onstatechange","state","puzTitle","getElementById","puzTable","puzAuthor","puzCopy","puzNotepad","clueContainer","acrossClues","downClues","singleClue","keyboard","screenToggle","splash","scores","myName","oppName","myScore","oppScore","logo","concessionBtn","firebase","db","firestore","messaging","isSupported","scoreValues","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","currentUser","auth","myOpponentUid","currentCell","acrossWord","game","columns","currentClue","idxArray","puzzleId","myTurn","clueNumIndices","onMessage","payload","log","onAuthStateChanged","user","sendTokenToServer","requestPermission","getToken","token","userStatusFirestoreRef","doc","uid","msgToken","merge","err","hash","innerText","showPuzzle","children","clearPuzzle","puzzle","notepad","innerHTML","classList","remove","title","author","copyright","cellDim","getCellDim","tableDim","rows","gridIndex","rowIndex","row","insertRow","width","colIndex","cols","clueNumber","grid","clueNum","cell","insertCell","blackCell","black","height","cellClicked","add","squareDiv","letterDiv","status","bgColor","guess","toString","clueNumDiv","createTextNode","circle","completedClues","across","down","clues","clue","parsedClue","split","parseInt","clueRef","clueText","clueDiv","id","includes","numDiv","textDiv","clueClicked","me","initiator","they","myNickname","displayName","oppNickname","score","replace","updateScoreHighlighting","emptySquares","result","winner","puzzleGames","showReplayDialog","savePuzzle","direction","clueNumberText","cellIndex","floor","col","selectAcross","selectDown","puzTableWidth","offsetWidth","clearLetters","getWordBlock","indexArray","rowOffset","clearHighlights","clueNumStr","textContent","scrollBy","offsetTop","left","behavior","currentCol","idx","currentRow","rowArray","loadPuzzle","paramObject","difficulty","directory","year","month","day","collection","onSnapshot","fetch","response","json","dir","years","getOwnPropertyNames","random","months","days","baseUrl","url","obj","parsePuzzle","saveNewPuzzle","fetchPuzzle","newPuzzleId","docRef","data","opponent","nextTurn","size","date","dow","editor","gridnums","circles","initiatorUid","iDisplayName","oDisplayName","squaresWon","errors","start","FieldValue","serverTimestamp","resizePuzzle","cellArray","toggleDrawer","MaterialLayout","playWord","alert","incomplete","correctAnswer","gridElement","setCellStatus","player","scoreCell","wordBlock","addedScore","enterLetter","letter","key","childNodes","undoEntry","nextCellIndex","localIdxArray","toUpperCase","replaceChild","concede","square","keyList","getElementsByClassName","toggleScreen","init","initApp","authButton","authContainer","profileName","avatar","kbContainer","firebaseui","ui","AuthUI","userStatusDatabaseRef","uiConfig","signInSuccessUrl","signInOptions","GoogleAuthProvider","PROVIDER_ID","EmailAuthProvider","tosUrl","privacyPolicyUrl","isOfflineForDatabase","lastChanged","database","ServerValue","TIMESTAMP","isOnlineForDatabase","isOfflineForFirestore","isOnlineForFirestore","photoURL","providerId","providerData","privateData","email","emailVerified","phoneNumber","src","ref","snapshot","onDisconnect","clearLists","signOut","gamesDialog","startGameButton","headerSignin","gameOverHeading","winMessage","opponentHeading","opponentList","radioEasy","radioMed","radioHard","dialogListContainer","activeGamesContainer","pastGamesContainer","dialogList","activeGamesHtml","pastGamesHtml","allUsers","initNewGame","closeGamesDialog","replayButton","subscribe","loadUserList","loadGames","unsubscribe","loadNewGame","empty","usersObj","docs","loadActiveGame","myOpponent","opponentPhoto","showPastGame","eventTarget","nodeName","replayOpponent","appContainer","gamesPanel","concessionBtnContainer","navigate"],"mappings":"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","file":"main.min.js","sourcesContent":["/* !\r\n * screenfull\r\n * v3.3.2 - 2017-10-27\r\n * (c) Sindre Sorhus; MIT License\r\n */\r\n/* eslint-env es6, browser */\r\n(function() {\r\n  'use strict';\r\n\r\n  let document;\r\n  if (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\r\n    document = window.document;\r\n  } else {\r\n    document = {};\r\n  }\r\n  const isCommonjs = typeof module !== 'undefined' && module.exports;\r\n  const keyboardAllowed =\r\n    typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\r\n\r\n  const fn = (function() {\r\n    let val;\r\n\r\n    const fnMap = [\r\n      [\r\n        'requestFullscreen',\r\n        'exitFullscreen',\r\n        'fullscreenElement',\r\n        'fullscreenEnabled',\r\n        'fullscreenchange',\r\n        'fullscreenerror',\r\n      ],\r\n      // New WebKit\r\n      [\r\n        'webkitRequestFullscreen',\r\n        'webkitExitFullscreen',\r\n        'webkitFullscreenElement',\r\n        'webkitFullscreenEnabled',\r\n        'webkitfullscreenchange',\r\n        'webkitfullscreenerror',\r\n\r\n      ],\r\n      // Old WebKit (Safari 5.1)\r\n      [\r\n        'webkitRequestFullScreen',\r\n        'webkitCancelFullScreen',\r\n        'webkitCurrentFullScreenElement',\r\n        'webkitCancelFullScreen',\r\n        'webkitfullscreenchange',\r\n        'webkitfullscreenerror',\r\n\r\n      ],\r\n      [\r\n        'mozRequestFullScreen',\r\n        'mozCancelFullScreen',\r\n        'mozFullScreenElement',\r\n        'mozFullScreenEnabled',\r\n        'mozfullscreenchange',\r\n        'mozfullscreenerror',\r\n      ],\r\n      [\r\n        'msRequestFullscreen',\r\n        'msExitFullscreen',\r\n        'msFullscreenElement',\r\n        'msFullscreenEnabled',\r\n        'MSFullscreenChange',\r\n        'MSFullscreenError',\r\n      ],\r\n    ];\r\n\r\n    let i = 0;\r\n    const l = fnMap.length;\r\n    const ret = {};\r\n\r\n    for (; i < l; i++) {\r\n      val = fnMap[i];\r\n      if (val && val[1] in document) {\r\n        for (i = 0; i < val.length; i++) {\r\n          ret[fnMap[0][i]] = val[i];\r\n        }\r\n        return ret;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  })();\r\n\r\n  const eventNameMap = {\r\n    change: fn.fullscreenchange,\r\n    error: fn.fullscreenerror,\r\n  };\r\n\r\n  const screenfull = {\r\n    request: function(elem) {\r\n      const request = fn.requestFullscreen;\r\n\r\n      elem = elem || document.documentElement;\r\n\r\n      // Work around Safari 5.1 bug: reports support for\r\n      // keyboard in fullscreen even though it doesn't.\r\n      // Browser sniffing, since the alternative with\r\n      // setTimeout is even worse.\r\n      if (/ Version\\/5\\.1(?:\\.\\d+)? Safari\\//.test(navigator.userAgent)) {\r\n        elem[request]();\r\n      } else {\r\n        elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\r\n      }\r\n    },\r\n    exit: function() {\r\n      document[fn.exitFullscreen]();\r\n    },\r\n    toggle: function(elem) {\r\n      if (this.isFullscreen) {\r\n        this.exit();\r\n      } else {\r\n        this.request(elem);\r\n      }\r\n    },\r\n    onchange: function(callback) {\r\n      this.on('change', callback);\r\n    },\r\n    onerror: function(callback) {\r\n      this.on('error', callback);\r\n    },\r\n    on: function(event, callback) {\r\n      const eventName = eventNameMap[event];\r\n      if (eventName) {\r\n        document.addEventListener(eventName, callback, false);\r\n      }\r\n    },\r\n    off: function(event, callback) {\r\n      const eventName = eventNameMap[event];\r\n      if (eventName) {\r\n        document.removeEventListener(eventName, callback, false);\r\n      }\r\n    },\r\n    raw: fn,\r\n  };\r\n\r\n  if (!fn) {\r\n    if (isCommonjs) {\r\n      module.exports = false;\r\n    } else {\r\n      window.screenfull = false;\r\n    }\r\n\r\n    return;\r\n  }\r\n\r\n  Object.defineProperties(screenfull, {\r\n    isFullscreen: {\r\n      get: function() {\r\n        return Boolean(document[fn.fullscreenElement]);\r\n      },\r\n    },\r\n    element: {\r\n      enumerable: true,\r\n      get: function() {\r\n        return document[fn.fullscreenElement];\r\n      },\r\n    },\r\n    enabled: {\r\n      enumerable: true,\r\n      get: function() {\r\n        // Coerce to boolean in case of old WebKit\r\n        return Boolean(document[fn.fullscreenEnabled]);\r\n      },\r\n    },\r\n  });\r\n\r\n  if (isCommonjs) {\r\n    module.exports = screenfull;\r\n  } else {\r\n    window.screenfull = screenfull;\r\n  }\r\n})();\r\n","/* eslint-disable */\r\n(function() {\r\n\r\n  // nb. This is for IE10 and lower _only_.\r\n  var supportCustomEvent = window.CustomEvent;\r\n  if (!supportCustomEvent || typeof supportCustomEvent === 'object') {\r\n    supportCustomEvent = function CustomEvent(event, x) {\r\n      x = x || {};\r\n      var ev = document.createEvent('CustomEvent');\r\n      ev.initCustomEvent(event, !!x.bubbles, !!x.cancelable, x.detail || null);\r\n      return ev;\r\n    };\r\n    supportCustomEvent.prototype = window.Event.prototype;\r\n  }\r\n\r\n  /**\r\n   * @param {Element} el to check for stacking context\r\n   * @return {boolean} whether this el or its parents creates a stacking context\r\n   */\r\n  function createsStackingContext(el) {\r\n    while (el && el !== document.body) {\r\n      var s = window.getComputedStyle(el);\r\n      var invalid = function(k, ok) {\r\n        return !(s[k] === undefined || s[k] === ok);\r\n      }\r\n      if (s.opacity < 1 ||\r\n          invalid('zIndex', 'auto') ||\r\n          invalid('transform', 'none') ||\r\n          invalid('mixBlendMode', 'normal') ||\r\n          invalid('filter', 'none') ||\r\n          invalid('perspective', 'none') ||\r\n          s['isolation'] === 'isolate' ||\r\n          s.position === 'fixed' ||\r\n          s.webkitOverflowScrolling === 'touch') {\r\n        return true;\r\n      }\r\n      el = el.parentElement;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Finds the nearest <dialog> from the passed element.\r\n   *\r\n   * @param {Element} el to search from\r\n   * @return {HTMLDialogElement} dialog found\r\n   */\r\n  function findNearestDialog(el) {\r\n    while (el) {\r\n      if (el.localName === 'dialog') {\r\n        return /** @type {HTMLDialogElement} */ (el);\r\n      }\r\n      el = el.parentElement;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Blur the specified element, as long as it's not the HTML body element.\r\n   * This works around an IE9/10 bug - blurring the body causes Windows to\r\n   * blur the whole application.\r\n   *\r\n   * @param {Element} el to blur\r\n   */\r\n  function safeBlur(el) {\r\n    if (el && el.blur && el !== document.body) {\r\n      el.blur();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {!NodeList} nodeList to search\r\n   * @param {Node} node to find\r\n   * @return {boolean} whether node is inside nodeList\r\n   */\r\n  function inNodeList(nodeList, node) {\r\n    for (var i = 0; i < nodeList.length; ++i) {\r\n      if (nodeList[i] === node) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {HTMLFormElement} el to check\r\n   * @return {boolean} whether this form has method=\"dialog\"\r\n   */\r\n  function isFormMethodDialog(el) {\r\n    if (!el || !el.hasAttribute('method')) {\r\n      return false;\r\n    }\r\n    return el.getAttribute('method').toLowerCase() === 'dialog';\r\n  }\r\n\r\n  /**\r\n   * @param {!HTMLDialogElement} dialog to upgrade\r\n   * @constructor\r\n   */\r\n  function dialogPolyfillInfo(dialog) {\r\n    this.dialog_ = dialog;\r\n    this.replacedStyleTop_ = false;\r\n    this.openAsModal_ = false;\r\n\r\n    // Set a11y role. Browsers that support dialog implicitly know this already.\r\n    if (!dialog.hasAttribute('role')) {\r\n      dialog.setAttribute('role', 'dialog');\r\n    }\r\n\r\n    dialog.show = this.show.bind(this);\r\n    dialog.showModal = this.showModal.bind(this);\r\n    dialog.close = this.close.bind(this);\r\n\r\n    if (!('returnValue' in dialog)) {\r\n      dialog.returnValue = '';\r\n    }\r\n\r\n    if ('MutationObserver' in window) {\r\n      var mo = new MutationObserver(this.maybeHideModal.bind(this));\r\n      mo.observe(dialog, {attributes: true, attributeFilter: ['open']});\r\n    } else {\r\n      // IE10 and below support. Note that DOMNodeRemoved etc fire _before_ removal. They also\r\n      // seem to fire even if the element was removed as part of a parent removal. Use the removed\r\n      // events to force downgrade (useful if removed/immediately added).\r\n      var removed = false;\r\n      var cb = function() {\r\n        removed ? this.downgradeModal() : this.maybeHideModal();\r\n        removed = false;\r\n      }.bind(this);\r\n      var timeout;\r\n      var delayModel = function(ev) {\r\n        if (ev.target !== dialog) { return; }  // not for a child element\r\n        var cand = 'DOMNodeRemoved';\r\n        removed |= (ev.type.substr(0, cand.length) === cand);\r\n        window.clearTimeout(timeout);\r\n        timeout = window.setTimeout(cb, 0);\r\n      };\r\n      ['DOMAttrModified', 'DOMNodeRemoved', 'DOMNodeRemovedFromDocument'].forEach(function(name) {\r\n        dialog.addEventListener(name, delayModel);\r\n      });\r\n    }\r\n    // Note that the DOM is observed inside DialogManager while any dialog\r\n    // is being displayed as a modal, to catch modal removal from the DOM.\r\n\r\n    Object.defineProperty(dialog, 'open', {\r\n      set: this.setOpen.bind(this),\r\n      get: dialog.hasAttribute.bind(dialog, 'open')\r\n    });\r\n\r\n    this.backdrop_ = document.createElement('div');\r\n    this.backdrop_.className = 'backdrop';\r\n    this.backdrop_.addEventListener('click', this.backdropClick_.bind(this));\r\n  }\r\n\r\n  dialogPolyfillInfo.prototype = {\r\n\r\n    get dialog() {\r\n      return this.dialog_;\r\n    },\r\n\r\n    /**\r\n     * Maybe remove this dialog from the modal top layer. This is called when\r\n     * a modal dialog may no longer be tenable, e.g., when the dialog is no\r\n     * longer open or is no longer part of the DOM.\r\n     */\r\n    maybeHideModal: function() {\r\n      if (this.dialog_.hasAttribute('open') && document.body.contains(this.dialog_)) { return; }\r\n      this.downgradeModal();\r\n    },\r\n\r\n    /**\r\n     * Remove this dialog from the modal top layer, leaving it as a non-modal.\r\n     */\r\n    downgradeModal: function() {\r\n      if (!this.openAsModal_) { return; }\r\n      this.openAsModal_ = false;\r\n      this.dialog_.style.zIndex = '';\r\n\r\n      // This won't match the native <dialog> exactly because if the user set top on a centered\r\n      // polyfill dialog, that top gets thrown away when the dialog is closed. Not sure it's\r\n      // possible to polyfill this perfectly.\r\n      if (this.replacedStyleTop_) {\r\n        this.dialog_.style.top = '';\r\n        this.replacedStyleTop_ = false;\r\n      }\r\n\r\n      // Clear the backdrop and remove from the manager.\r\n      this.backdrop_.parentNode && this.backdrop_.parentNode.removeChild(this.backdrop_);\r\n      dialogPolyfill.dm.removeDialog(this);\r\n    },\r\n\r\n    /**\r\n     * @param {boolean} value whether to open or close this dialog\r\n     */\r\n    setOpen: function(value) {\r\n      if (value) {\r\n        this.dialog_.hasAttribute('open') || this.dialog_.setAttribute('open', '');\r\n      } else {\r\n        this.dialog_.removeAttribute('open');\r\n        this.maybeHideModal();  // nb. redundant with MutationObserver\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Handles clicks on the fake .backdrop element, redirecting them as if\r\n     * they were on the dialog itself.\r\n     *\r\n     * @param {!Event} e to redirect\r\n     */\r\n    backdropClick_: function(e) {\r\n      if (!this.dialog_.hasAttribute('tabindex')) {\r\n        // Clicking on the backdrop should move the implicit cursor, even if dialog cannot be\r\n        // focused. Create a fake thing to focus on. If the backdrop was _before_ the dialog, this\r\n        // would not be needed - clicks would move the implicit cursor there.\r\n        var fake = document.createElement('div');\r\n        this.dialog_.insertBefore(fake, this.dialog_.firstChild);\r\n        fake.tabIndex = -1;\r\n        fake.focus();\r\n        this.dialog_.removeChild(fake);\r\n      } else {\r\n        this.dialog_.focus();\r\n      }\r\n\r\n      var redirectedEvent = document.createEvent('MouseEvents');\r\n      redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\r\n          e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\r\n          e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\r\n      this.dialog_.dispatchEvent(redirectedEvent);\r\n      e.stopPropagation();\r\n    },\r\n\r\n    /**\r\n     * Focuses on the first focusable element within the dialog. This will always blur the current\r\n     * focus, even if nothing within the dialog is found.\r\n     */\r\n    focus_: function() {\r\n      // Find element with `autofocus` attribute, or fall back to the first form/tabindex control.\r\n      var target = this.dialog_.querySelector('[autofocus]:not([disabled])');\r\n      if (!target && this.dialog_.tabIndex >= 0) {\r\n        target = this.dialog_;\r\n      }\r\n      if (!target) {\r\n        // Note that this is 'any focusable area'. This list is probably not exhaustive, but the\r\n        // alternative involves stepping through and trying to focus everything.\r\n        var opts = ['button', 'input', 'keygen', 'select', 'textarea'];\r\n        var query = opts.map(function(el) {\r\n          return el + ':not([disabled])';\r\n        });\r\n        // TODO(samthor): tabindex values that are not numeric are not focusable.\r\n        query.push('[tabindex]:not([disabled]):not([tabindex=\"\"])');  // tabindex != \"\", not disabled\r\n        target = this.dialog_.querySelector(query.join(', '));\r\n      }\r\n      safeBlur(document.activeElement);\r\n      target && target.focus();\r\n    },\r\n\r\n    /**\r\n     * Sets the zIndex for the backdrop and dialog.\r\n     *\r\n     * @param {number} dialogZ\r\n     * @param {number} backdropZ\r\n     */\r\n    updateZIndex: function(dialogZ, backdropZ) {\r\n      if (dialogZ < backdropZ) {\r\n        throw new Error('dialogZ should never be < backdropZ');\r\n      }\r\n      this.dialog_.style.zIndex = dialogZ;\r\n      this.backdrop_.style.zIndex = backdropZ;\r\n    },\r\n\r\n    /**\r\n     * Shows the dialog. If the dialog is already open, this does nothing.\r\n     */\r\n    show: function() {\r\n      if (!this.dialog_.open) {\r\n        this.setOpen(true);\r\n        this.focus_();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Show this dialog modally.\r\n     */\r\n    showModal: function() {\r\n      if (this.dialog_.hasAttribute('open')) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: The element is already open, and therefore cannot be opened modally.');\r\n      }\r\n      if (!document.body.contains(this.dialog_)) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: The element is not in a Document.');\r\n      }\r\n      if (!dialogPolyfill.dm.pushDialog(this)) {\r\n        throw new Error('Failed to execute \\'showModal\\' on dialog: There are too many open modal dialogs.');\r\n      }\r\n\r\n      if (createsStackingContext(this.dialog_.parentElement)) {\r\n        console.warn('A dialog is being shown inside a stacking context. ' +\r\n            'This may cause it to be unusable. For more information, see this link: ' +\r\n            'https://github.com/GoogleChrome/dialog-polyfill/#stacking-context');\r\n      }\r\n\r\n      this.setOpen(true);\r\n      this.openAsModal_ = true;\r\n\r\n      // Optionally center vertically, relative to the current viewport.\r\n      if (dialogPolyfill.needsCentering(this.dialog_)) {\r\n        dialogPolyfill.reposition(this.dialog_);\r\n        this.replacedStyleTop_ = true;\r\n      } else {\r\n        this.replacedStyleTop_ = false;\r\n      }\r\n\r\n      // Insert backdrop.\r\n      this.dialog_.parentNode.insertBefore(this.backdrop_, this.dialog_.nextSibling);\r\n\r\n      // Focus on whatever inside the dialog.\r\n      this.focus_();\r\n    },\r\n\r\n    /**\r\n     * Closes this HTMLDialogElement. This is optional vs clearing the open\r\n     * attribute, however this fires a 'close' event.\r\n     *\r\n     * @param {string=} opt_returnValue to use as the returnValue\r\n     */\r\n    close: function(opt_returnValue) {\r\n      if (!this.dialog_.hasAttribute('open')) {\r\n        throw new Error('Failed to execute \\'close\\' on dialog: The element does not have an \\'open\\' attribute, and therefore cannot be closed.');\r\n      }\r\n      this.setOpen(false);\r\n\r\n      // Leave returnValue untouched in case it was set directly on the element\r\n      if (opt_returnValue !== undefined) {\r\n        this.dialog_.returnValue = opt_returnValue;\r\n      }\r\n\r\n      // Triggering \"close\" event for any attached listeners on the <dialog>.\r\n      var closeEvent = new supportCustomEvent('close', {\r\n        bubbles: false,\r\n        cancelable: false\r\n      });\r\n      this.dialog_.dispatchEvent(closeEvent);\r\n    }\r\n\r\n  };\r\n\r\n  var dialogPolyfill = {};\r\n\r\n  dialogPolyfill.reposition = function(element) {\r\n    var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\r\n    var topValue = scrollTop + (window.innerHeight - element.offsetHeight) / 2;\r\n    element.style.top = Math.max(scrollTop, topValue) + 'px';\r\n  };\r\n\r\n  dialogPolyfill.isInlinePositionSetByStylesheet = function(element) {\r\n    for (var i = 0; i < document.styleSheets.length; ++i) {\r\n      var styleSheet = document.styleSheets[i];\r\n      var cssRules = null;\r\n      // Some browsers throw on cssRules.\r\n      try {\r\n        cssRules = styleSheet.cssRules;\r\n      } catch (e) {}\r\n      if (!cssRules) { continue; }\r\n      for (var j = 0; j < cssRules.length; ++j) {\r\n        var rule = cssRules[j];\r\n        var selectedNodes = null;\r\n        // Ignore errors on invalid selector texts.\r\n        try {\r\n          selectedNodes = document.querySelectorAll(rule.selectorText);\r\n        } catch(e) {}\r\n        if (!selectedNodes || !inNodeList(selectedNodes, element)) {\r\n          continue;\r\n        }\r\n        var cssTop = rule.style.getPropertyValue('top');\r\n        var cssBottom = rule.style.getPropertyValue('bottom');\r\n        if ((cssTop && cssTop !== 'auto') || (cssBottom && cssBottom !== 'auto')) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.needsCentering = function(dialog) {\r\n    var computedStyle = window.getComputedStyle(dialog);\r\n    if (computedStyle.position !== 'absolute') {\r\n      return false;\r\n    }\r\n\r\n    // We must determine whether the top/bottom specified value is non-auto.  In\r\n    // WebKit/Blink, checking computedStyle.top == 'auto' is sufficient, but\r\n    // Firefox returns the used value. So we do this crazy thing instead: check\r\n    // the inline style and then go through CSS rules.\r\n    if ((dialog.style.top !== 'auto' && dialog.style.top !== '') ||\r\n        (dialog.style.bottom !== 'auto' && dialog.style.bottom !== '')) {\r\n      return false;\r\n    }\r\n    return !dialogPolyfill.isInlinePositionSetByStylesheet(dialog);\r\n  };\r\n\r\n  /**\r\n   * @param {!Element} element to force upgrade\r\n   */\r\n  dialogPolyfill.forceRegisterDialog = function(element) {\r\n    if (window.HTMLDialogElement || element.showModal) {\r\n      console.warn('This browser already supports <dialog>, the polyfill ' +\r\n          'may not work correctly', element);\r\n    }\r\n    if (element.localName !== 'dialog') {\r\n      throw new Error('Failed to register dialog: The element is not a dialog.');\r\n    }\r\n    new dialogPolyfillInfo(/** @type {!HTMLDialogElement} */ (element));\r\n  };\r\n\r\n  /**\r\n   * @param {!Element} element to upgrade, if necessary\r\n   */\r\n  dialogPolyfill.registerDialog = function(element) {\r\n    if (!element.showModal) {\r\n      dialogPolyfill.forceRegisterDialog(element);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @constructor\r\n   */\r\n  dialogPolyfill.DialogManager = function() {\r\n    /** @type {!Array<!dialogPolyfillInfo>} */\r\n    this.pendingDialogStack = [];\r\n\r\n    var checkDOM = this.checkDOM_.bind(this);\r\n\r\n    // The overlay is used to simulate how a modal dialog blocks the document.\r\n    // The blocking dialog is positioned on top of the overlay, and the rest of\r\n    // the dialogs on the pending dialog stack are positioned below it. In the\r\n    // actual implementation, the modal dialog stacking is controlled by the\r\n    // top layer, where z-index has no effect.\r\n    this.overlay = document.createElement('div');\r\n    this.overlay.className = '_dialog_overlay';\r\n    this.overlay.addEventListener('click', function(e) {\r\n      this.forwardTab_ = undefined;\r\n      e.stopPropagation();\r\n      checkDOM([]);  // sanity-check DOM\r\n    }.bind(this));\r\n\r\n    this.handleKey_ = this.handleKey_.bind(this);\r\n    this.handleFocus_ = this.handleFocus_.bind(this);\r\n\r\n    this.zIndexLow_ = 100000;\r\n    this.zIndexHigh_ = 100000 + 150;\r\n\r\n    this.forwardTab_ = undefined;\r\n\r\n    if ('MutationObserver' in window) {\r\n      this.mo_ = new MutationObserver(function(records) {\r\n        var removed = [];\r\n        records.forEach(function(rec) {\r\n          for (var i = 0, c; c = rec.removedNodes[i]; ++i) {\r\n            if (!(c instanceof Element)) {\r\n              continue;\r\n            } else if (c.localName === 'dialog') {\r\n              removed.push(c);\r\n            }\r\n            removed = removed.concat(c.querySelectorAll('dialog'));\r\n          }\r\n        });\r\n        removed.length && checkDOM(removed);\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Called on the first modal dialog being shown. Adds the overlay and related\r\n   * handlers.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.blockDocument = function() {\r\n    document.documentElement.addEventListener('focus', this.handleFocus_, true);\r\n    document.addEventListener('keydown', this.handleKey_);\r\n    this.mo_ && this.mo_.observe(document, {childList: true, subtree: true});\r\n  };\r\n\r\n  /**\r\n   * Called on the first modal dialog being removed, i.e., when no more modal\r\n   * dialogs are visible.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.unblockDocument = function() {\r\n    document.documentElement.removeEventListener('focus', this.handleFocus_, true);\r\n    document.removeEventListener('keydown', this.handleKey_);\r\n    this.mo_ && this.mo_.disconnect();\r\n  };\r\n\r\n  /**\r\n   * Updates the stacking of all known dialogs.\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.updateStacking = function() {\r\n    var zIndex = this.zIndexHigh_;\r\n\r\n    for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\r\n      dpi.updateZIndex(--zIndex, --zIndex);\r\n      if (i === 0) {\r\n        this.overlay.style.zIndex = --zIndex;\r\n      }\r\n    }\r\n\r\n    // Make the overlay a sibling of the dialog itself.\r\n    var last = this.pendingDialogStack[0];\r\n    if (last) {\r\n      var p = last.dialog.parentNode || document.body;\r\n      p.appendChild(this.overlay);\r\n    } else if (this.overlay.parentNode) {\r\n      this.overlay.parentNode.removeChild(this.overlay);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @param {Element} candidate to check if contained or is the top-most modal dialog\r\n   * @return {boolean} whether candidate is contained in top dialog\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.containedByTopDialog_ = function(candidate) {\r\n    while (candidate = findNearestDialog(candidate)) {\r\n      for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\r\n        if (dpi.dialog === candidate) {\r\n          return i === 0;  // only valid if top-most\r\n        }\r\n      }\r\n      candidate = candidate.parentElement;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.DialogManager.prototype.handleFocus_ = function(event) {\r\n    if (this.containedByTopDialog_(event.target)) { return; }\r\n\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    safeBlur(/** @type {Element} */ (event.target));\r\n\r\n    if (this.forwardTab_ === undefined) { return; }  // move focus only from a tab key\r\n\r\n    var dpi = this.pendingDialogStack[0];\r\n    var dialog = dpi.dialog;\r\n    var position = dialog.compareDocumentPosition(event.target);\r\n    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\r\n      if (this.forwardTab_) {  // forward\r\n        dpi.focus_();\r\n      } else {  // backwards\r\n        document.documentElement.focus();\r\n      }\r\n    } else {\r\n      // TODO: Focus after the dialog, is ignored.\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  dialogPolyfill.DialogManager.prototype.handleKey_ = function(event) {\r\n    this.forwardTab_ = undefined;\r\n    if (event.keyCode === 27) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      var cancelEvent = new supportCustomEvent('cancel', {\r\n        bubbles: false,\r\n        cancelable: true\r\n      });\r\n      var dpi = this.pendingDialogStack[0];\r\n      if (dpi && dpi.dialog.dispatchEvent(cancelEvent)) {\r\n        dpi.dialog.close();\r\n      }\r\n    } else if (event.keyCode === 9) {\r\n      this.forwardTab_ = !event.shiftKey;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Finds and downgrades any known modal dialogs that are no longer displayed. Dialogs that are\r\n   * removed and immediately readded don't stay modal, they become normal.\r\n   *\r\n   * @param {!Array<!HTMLDialogElement>} removed that have definitely been removed\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.checkDOM_ = function(removed) {\r\n    // This operates on a clone because it may cause it to change. Each change also calls\r\n    // updateStacking, which only actually needs to happen once. But who removes many modal dialogs\r\n    // at a time?!\r\n    var clone = this.pendingDialogStack.slice();\r\n    clone.forEach(function(dpi) {\r\n      if (removed.indexOf(dpi.dialog) !== -1) {\r\n        dpi.downgradeModal();\r\n      } else {\r\n        dpi.maybeHideModal();\r\n      }\r\n    });\r\n  };\r\n\r\n  /**\r\n   * @param {!dialogPolyfillInfo} dpi\r\n   * @return {boolean} whether the dialog was allowed\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.pushDialog = function(dpi) {\r\n    var allowed = (this.zIndexHigh_ - this.zIndexLow_) / 2 - 1;\r\n    if (this.pendingDialogStack.length >= allowed) {\r\n      return false;\r\n    }\r\n    if (this.pendingDialogStack.unshift(dpi) === 1) {\r\n      this.blockDocument();\r\n    }\r\n    this.updateStacking();\r\n    return true;\r\n  };\r\n\r\n  /**\r\n   * @param {!dialogPolyfillInfo} dpi\r\n   */\r\n  dialogPolyfill.DialogManager.prototype.removeDialog = function(dpi) {\r\n    var index = this.pendingDialogStack.indexOf(dpi);\r\n    if (index === -1) { return; }\r\n\r\n    this.pendingDialogStack.splice(index, 1);\r\n    if (this.pendingDialogStack.length === 0) {\r\n      this.unblockDocument();\r\n    }\r\n    this.updateStacking();\r\n  };\r\n\r\n  dialogPolyfill.dm = new dialogPolyfill.DialogManager();\r\n  dialogPolyfill.formSubmitter = null;\r\n  dialogPolyfill.useValue = null;\r\n\r\n  /**\r\n   * Installs global handlers, such as click listers and native method overrides. These are needed\r\n   * even if a no dialog is registered, as they deal with <form method=\"dialog\">.\r\n   */\r\n  if (window.HTMLDialogElement === undefined) {\r\n\r\n    /**\r\n     * If HTMLFormElement translates method=\"DIALOG\" into 'get', then replace the descriptor with\r\n     * one that returns the correct value.\r\n     */\r\n    var testForm = document.createElement('form');\r\n    testForm.setAttribute('method', 'dialog');\r\n    if (testForm.method !== 'dialog') {\r\n      var methodDescriptor = Object.getOwnPropertyDescriptor(HTMLFormElement.prototype, 'method');\r\n      if (methodDescriptor) {\r\n        // TODO: older iOS and older PhantomJS fail to return the descriptor here\r\n        var realGet = methodDescriptor.get;\r\n        methodDescriptor.get = function() {\r\n          if (isFormMethodDialog(this)) {\r\n            return 'dialog';\r\n          }\r\n          return realGet.call(this);\r\n        };\r\n        var realSet = methodDescriptor.set;\r\n        methodDescriptor.set = function(v) {\r\n          if (typeof v === 'string' && v.toLowerCase() === 'dialog') {\r\n            return this.setAttribute('method', v);\r\n          }\r\n          return realSet.call(this, v);\r\n        };\r\n        Object.defineProperty(HTMLFormElement.prototype, 'method', methodDescriptor);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Global 'click' handler, to capture the <input type=\"submit\"> or <button> element which has\r\n     * submitted a <form method=\"dialog\">. Needed as Safari and others don't report this inside\r\n     * document.activeElement.\r\n     */\r\n    document.addEventListener('click', function(ev) {\r\n      dialogPolyfill.formSubmitter = null;\r\n      dialogPolyfill.useValue = null;\r\n      if (ev.defaultPrevented) { return; }  // e.g. a submit which prevents default submission\r\n\r\n      var target = /** @type {Element} */ (ev.target);\r\n      if (!target || !isFormMethodDialog(target.form)) { return; }\r\n\r\n      var valid = (target.type === 'submit' && ['button', 'input'].indexOf(target.localName) > -1);\r\n      if (!valid) {\r\n        if (!(target.localName === 'input' && target.type === 'image')) { return; }\r\n        // this is a <input type=\"image\">, which can submit forms\r\n        dialogPolyfill.useValue = ev.offsetX + ',' + ev.offsetY;\r\n      }\r\n\r\n      var dialog = findNearestDialog(target);\r\n      if (!dialog) { return; }\r\n\r\n      dialogPolyfill.formSubmitter = target;\r\n    }, false);\r\n\r\n    /**\r\n     * Replace the native HTMLFormElement.submit() method, as it won't fire the\r\n     * submit event and give us a chance to respond.\r\n     */\r\n    var nativeFormSubmit = HTMLFormElement.prototype.submit;\r\n    function replacementFormSubmit() {\r\n      if (!isFormMethodDialog(this)) {\r\n        return nativeFormSubmit.call(this);\r\n      }\r\n      var dialog = findNearestDialog(this);\r\n      dialog && dialog.close();\r\n    }\r\n    HTMLFormElement.prototype.submit = replacementFormSubmit;\r\n\r\n    /**\r\n     * Global form 'dialog' method handler. Closes a dialog correctly on submit\r\n     * and possibly sets its return value.\r\n     */\r\n    document.addEventListener('submit', function(ev) {\r\n      var form = /** @type {HTMLFormElement} */ (ev.target);\r\n      if (!isFormMethodDialog(form)) { return; }\r\n      ev.preventDefault();\r\n\r\n      var dialog = findNearestDialog(form);\r\n      if (!dialog) { return; }\r\n\r\n      // Forms can only be submitted via .submit() or a click (?), but anyway: sanity-check that\r\n      // the submitter is correct before using its value as .returnValue.\r\n      var s = dialogPolyfill.formSubmitter;\r\n      if (s && s.form === form) {\r\n        dialog.close(dialogPolyfill.useValue || s.value);\r\n      } else {\r\n        dialog.close();\r\n      }\r\n      dialogPolyfill.formSubmitter = null;\r\n    }, true);\r\n  }\r\n\r\n  dialogPolyfill['forceRegisterDialog'] = dialogPolyfill.forceRegisterDialog;\r\n  dialogPolyfill['registerDialog'] = dialogPolyfill.registerDialog;\r\n\r\n  if (typeof define === 'function' && 'amd' in define) {\r\n    // AMD support\r\n    define(function() { return dialogPolyfill; });\r\n  } else if (typeof module === 'object' && typeof module['exports'] === 'object') {\r\n    // CommonJS support\r\n    module['exports'] = dialogPolyfill;\r\n  } else {\r\n    // all others\r\n    window['dialogPolyfill'] = dialogPolyfill;\r\n  }\r\n})();\r\n/* eslint-enable */\r\n","/* eslint-env es6, browser */\r\nconst puzzleWorker = (function() {\r\n  'use strict';\r\n\r\n  // Check to make sure service workers are supported in the current browser,\r\n  // and that the current page is accessed from a secure origin. Using a\r\n  // service worker from an insecure origin will trigger JS console errors. See\r\n  // http://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features\r\n  const isLocalhost = Boolean(\r\n      window.location.hostname === 'localhost' ||\r\n      // [::1] is the IPv6 localhost address.\r\n      window.location.hostname === '[::1]' ||\r\n      // 127.0.0.1/8 is considered localhost for IPv4.\r\n      window.location.hostname.match(\r\n          /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n      )\r\n  );\r\n\r\n  if (\r\n    'serviceWorker' in navigator &&\r\n    (window.location.protocol === 'https:' || isLocalhost)\r\n  ) {\r\n    navigator.serviceWorker\r\n        .register('service-worker.js')\r\n        .then(function(registration) {\r\n          // updatefound is fired if service-worker.js changes.\r\n          registration.onupdatefound = function() {\r\n            // updatefound is also fired the very first time the SW is\r\n            // installed, and there's no need to prompt for a reload at\r\n            // that point.\r\n            // So check here to see if the page is already controlled,\r\n            // i.e. whether there's an existing service worker.\r\n            if (navigator.serviceWorker.controller) {\r\n              // The updatefound event implies that registration.installing is\r\n              // set:\r\n              // https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-container-updatefound-event\r\n              const installingWorker = registration.installing;\r\n\r\n              installingWorker.onstatechange = function() {\r\n                switch (installingWorker.state) {\r\n                  case 'installed':\r\n                    // At this point, the old content will have been purged\r\n                    // and the fresh content will have been added to the\r\n                    // cache. It's the perfect time to display a \"New\r\n                    // content is available; please refresh.\" message in\r\n                    // the page's interface.\r\n                    break;\r\n\r\n                  case 'redundant':\r\n                    throw new Error(\r\n                        'The installing service worker became redundant.'\r\n                    );\r\n\r\n                  default:\r\n                    // Ignore\r\n                }\r\n              };\r\n            }\r\n          };\r\n        })\r\n        .catch(function(e) {\r\n          console.error('Error during service worker registration:', e);\r\n        });\r\n  }\r\n\r\n  // const yearPicker = document.getElementById('pickYear');\r\n  // const monthPicker = document.getElementById('pickMonth');\r\n  // const dayPicker = document.getElementById('pickDay');\r\n  const puzTitle = document.getElementById('puzTitle');\r\n  const puzTable = document.getElementById('puzTable');\r\n  const puzAuthor = document.getElementById('puzAuthor');\r\n  const puzCopy = document.getElementById('puzCopy');\r\n  const puzNotepad = document.getElementById('puzNotepad');\r\n  const clueContainer = document.getElementById('clueContainer');\r\n  const acrossClues = document.getElementById('acrossClues');\r\n  const downClues = document.getElementById('downClues');\r\n  const singleClue = document.getElementById('singleClue');\r\n  const keyboard = document.getElementById('kbContainer');\r\n  const screenToggle = document.getElementById('screenToggle');\r\n  const splash = document.getElementById('splash');\r\n  const scores = document.getElementById('scores');\r\n  const myName = document.getElementById('myName');\r\n  const oppName = document.getElementById('oppName');\r\n  const myScore = document.getElementById('myScore');\r\n  const oppScore = document.getElementById('oppScore');\r\n  const logo = document.getElementById('logo');\r\n  const concessionBtn = document.getElementById('concessionBtn');\r\n  const firebase = window.firebase;\r\n  const db = firebase.firestore();\r\n  const messaging = firebase.messaging.isSupported() ?\r\n      firebase.messaging() : null;\r\n  const scoreValues = {\r\n    A: 1, B: 4, C: 4, D: 2, E: 1, F: 4, G: 3, H: 4, I: 1, J: 10, K: 5, L: 2,\r\n    M: 4, N: 2, O: 1, P: 4, Q: 10, R: 1, S: 1, T: 1, U: 2, V: 5, W: 4, X: 8,\r\n    Y: 4, Z: 10,\r\n  };\r\n\r\n  let currentUser = firebase.auth().currentUser;\r\n  let myOpponentUid = null;\r\n  let currentCell = null;\r\n  let acrossWord = true;\r\n  let game = null;\r\n  let columns = null;\r\n  let currentClue = null;\r\n  let idxArray = [];\r\n  let puzzleId = null;\r\n  let myTurn = null;\r\n  let clueNumIndices = {};\r\n\r\n  if (messaging) {\r\n    messaging.onMessage((payload) => {\r\n      console.log('onMessage: ', payload);\r\n    });\r\n  }\r\n\r\n  firebase.auth().onAuthStateChanged((user) => {\r\n    if (user) {\r\n      currentUser = user;\r\n      if (messaging) {\r\n        sendTokenToServer();\r\n      }\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Send cloud messaging token to server\r\n   * @param {string} token Cloud messaging token\r\n   */\r\n  function sendTokenToServer() {\r\n    messaging.requestPermission()\r\n        .then(() => {\r\n          return messaging.getToken();\r\n        })\r\n        .then((token) => {\r\n          console.log('Permission granted. Token: ', token);\r\n          const userStatusFirestoreRef = firebase\r\n              .firestore()\r\n              .doc(`/users/${currentUser.uid}`);\r\n          userStatusFirestoreRef.set({msgToken: token}, {merge: true});\r\n        })\r\n        .catch((err) => {\r\n          console.log('User denied messaging', err);\r\n        });\r\n  }\r\n\r\n  logo.addEventListener('click', () => {\r\n    location.hash = '#games';\r\n  });\r\n\r\n  puzTitle.innerText = 'No puzzle loaded';\r\n\r\n  /**\r\n   * This function takes the puzzle object returned from the fetch and displays\r\n   * a grid and clues. The HTML table element is a placeholder and the rows and\r\n   * cells are created on the fly. The fetched puzzle is stored as an object in\r\n   * the variable \"game\".\r\n   */\r\n  function showPuzzle() {\r\n    // clear previous puzzle if it exists\r\n    if (puzTable.children) {\r\n      clearPuzzle();\r\n    }\r\n    idxArray = [];\r\n    clueNumIndices = {};\r\n    // initial estimate of element size used to determine\r\n    // cellDim -> tableDim -> puzzle size\r\n    if (game.puzzle.notepad) {\r\n      // puzNotepad.style.width = '300px';\r\n      puzNotepad.innerHTML = `<b>Notepad:</b>${game.puzzle.notepad}`;\r\n      puzNotepad.classList.remove('displayNone');\r\n    }\r\n    puzTitle.innerText = game.puzzle.title ? game.puzzle.title : 'Untitled';\r\n    puzAuthor.innerText = `by ${\r\n      game.puzzle.author ? game.puzzle.author : 'Anonymous'\r\n    }`;\r\n    puzCopy.innerHTML = game.puzzle.copyright ?\r\n      `&copy; ${game.puzzle.copyright}` :\r\n      '';\r\n\r\n    const cellDim = getCellDim();\r\n    const tableDim = cellDim * game.puzzle.rows;\r\n    let gridIndex = 0;\r\n    for (let rowIndex = 0; rowIndex < game.puzzle.rows; rowIndex += 1) {\r\n      const row = puzTable.insertRow(rowIndex);\r\n      row.style.width = `${tableDim}px`;\r\n      for (let colIndex = 0; colIndex < game.puzzle.cols; colIndex += 1) {\r\n        const clueNumber = game.puzzle.grid[gridIndex].clueNum;\r\n        const cell = row.insertCell(colIndex);\r\n        const blackCell = game.puzzle.grid[gridIndex].black;\r\n\r\n        cell.style.width = `${cellDim}px`;\r\n        cell.style.height = `${cellDim}px`;\r\n        cell.addEventListener('click', cellClicked);\r\n        if (blackCell) {\r\n          cell.className = 'black';\r\n        } else {\r\n          cell.classList.add('cursorPointer');\r\n          const squareDiv = document.createElement('div');\r\n          const letterDiv = document.createElement('div');\r\n          squareDiv.classList.add('square');\r\n          letterDiv.classList.add('marginAuto');\r\n          if (game.puzzle.grid[gridIndex].status === 'locked') {\r\n            cell.classList.add(game.puzzle.grid[gridIndex].bgColor);\r\n          }\r\n          const guess = game.puzzle.grid[gridIndex].guess;\r\n          letterDiv.innerText = guess ? guess : '';\r\n          squareDiv.appendChild(letterDiv);\r\n          cell.appendChild(squareDiv);\r\n          if (clueNumber !== '') {\r\n            clueNumIndices[clueNumber.toString()] = gridIndex;\r\n            const clueNumDiv = document.createElement('div');\r\n            clueNumDiv.classList.add('clueNumber');\r\n            clueNumDiv.appendChild(document.createTextNode(clueNumber));\r\n            cell.appendChild(clueNumDiv);\r\n          }\r\n          if (game.puzzle.grid[gridIndex].circle) {\r\n            cell.children[0].classList.add('circle');\r\n          }\r\n        }\r\n        gridIndex += 1;\r\n      }\r\n    }\r\n\r\n    keyboard.classList.remove('displayNone');\r\n    keyboard.classList.add('displayFlex');\r\n    clueContainer.classList.remove('displayNone');\r\n    splash.classList.add('displayNone');\r\n\r\n    if (!game.puzzle.completedClues) {\r\n      game.puzzle.completedClues = {};\r\n      game.puzzle.completedClues.across = [];\r\n      game.puzzle.completedClues.down = [];\r\n    }\r\n\r\n    // create contents for across clues div\r\n    for (const clue of game.puzzle.clues.across) {\r\n      const parsedClue = clue.split('.');\r\n      const clueNumber = parseInt(parsedClue[0], 10);\r\n      const clueRef = parsedClue[0] + '.';\r\n      const clueText = parsedClue.slice(1).join('.');\r\n      const clueDiv = document.createElement('div');\r\n      clueDiv.classList.add('displayFlex', 'cursorPointer');\r\n      clueDiv.id = 'across' + clueNumber;\r\n      if (game.puzzle.completedClues.across.includes(clueNumber)) {\r\n        clueDiv.classList.add('colorLightGray');\r\n      }\r\n\r\n      const numDiv = document.createElement('div');\r\n      numDiv.appendChild(document.createTextNode(clueRef));\r\n      numDiv.classList.add('padRight', 'cursorPointer');\r\n\r\n      const textDiv = document.createElement('div');\r\n      textDiv.appendChild(document.createTextNode(clueText));\r\n      textDiv.classList.add('cursorPointer');\r\n      clueDiv.appendChild(numDiv);\r\n      clueDiv.appendChild(textDiv);\r\n      // clueDiv.addEventListener('click', acrossClueClick);\r\n      acrossClues.appendChild(clueDiv);\r\n    }\r\n\r\n    // create contents for down clues div\r\n    for (const clue of game.puzzle.clues.down) {\r\n      const parsedClue = clue.split('.');\r\n      const clueNumber = parseInt(parsedClue[0], 10);\r\n      const clueRef = parsedClue[0] + '.';\r\n      const clueText = parsedClue.slice(1).join('.');\r\n      const clueDiv = document.createElement('div');\r\n      clueDiv.classList.add('displayFlex', 'cursorPointer');\r\n      clueDiv.id = 'down' + clueNumber;\r\n      if (game.puzzle.completedClues.down.includes(clueNumber)) {\r\n        clueDiv.classList.add('colorLightGray');\r\n      }\r\n\r\n      const numDiv = document.createElement('div');\r\n      numDiv.appendChild(document.createTextNode(clueRef));\r\n      numDiv.classList.add('padRight', 'cursorPointer');\r\n\r\n      const textDiv = document.createElement('div');\r\n      textDiv.appendChild(document.createTextNode(clueText));\r\n      textDiv.classList.add('cursorPointer');\r\n      clueDiv.appendChild(numDiv);\r\n      clueDiv.appendChild(textDiv);\r\n      downClues.appendChild(clueDiv);\r\n    }\r\n\r\n    acrossClues.addEventListener('click', (event) => {\r\n      if (event.target.innerText !== '') {\r\n        clueClicked(event, 'across');\r\n      }\r\n    });\r\n\r\n    downClues.addEventListener('click', (event) => {\r\n      if (event.target.innerText !== '') {\r\n        clueClicked(event, 'down');\r\n      }\r\n    });\r\n\r\n    scores.classList.remove('displayNone');\r\n    scores.classList.add('displayFlex');\r\n    const me = currentUser.uid === game.initiator.uid ?\r\n        'initiator' : 'opponent';\r\n    const they = me === 'initiator' ? 'opponent' : 'initiator';\r\n    let myNickname = game[me].displayName;\r\n    let oppNickname = game[they].displayName;\r\n\r\n    myNickname =\r\n      myNickname.indexOf(' ') === -1 ?\r\n      myNickname :\r\n      myNickname.slice(0, myNickname.indexOf(' '));\r\n    myNickname = myNickname.length > 8 ? myNickname.slice(0, 8) : myNickname;\r\n    myName.innerText = myNickname;\r\n    oppNickname =\r\n      oppNickname.indexOf(' ') === -1 ?\r\n      oppNickname :\r\n      oppNickname.slice(0, oppNickname.indexOf(' '));\r\n    oppNickname =\r\n      oppNickname.length > 8 ? oppNickname.slice(0, 8) : oppNickname;\r\n    oppName.innerText = oppNickname;\r\n    myScore.innerText = game[me].score;\r\n    oppScore.innerText = game[they].score;\r\n    myName.classList.add(game[me].bgColor.replace('bg', 'font'));\r\n    oppName.classList.add(game[they].bgColor.replace('bg', 'font'));\r\n    updateScoreHighlighting();\r\n    if (game.emptySquares === 0) {\r\n      let result = 'YOU WON!!';\r\n      if (game[me].score > game[they].score) {\r\n        game.winner = game[me].uid;\r\n      } else {\r\n        game.winner = game[they].uid;\r\n        result = 'You lost';\r\n      }\r\n      game.status = 'finished';\r\n      window.puzzleGames.showReplayDialog(game, result);\r\n      savePuzzle();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * When clue is clicked, this event fires\r\n   * @param {Event} event Mouse click or screen touch event\r\n   * @param {string} direction Clue direction (across or down)\r\n   */\r\n  function clueClicked(event, direction) {\r\n    let clueNumberText = event.target.parentElement.firstChild.innerText;\r\n    clueNumberText = clueNumberText.slice(0, clueNumberText.indexOf('.'));\r\n    const cellIndex = clueNumIndices[clueNumberText];\r\n    const row = Math.floor(cellIndex / columns);\r\n    const col = cellIndex - row * columns;\r\n    const cell = puzTable.firstChild.children[row].children[col];\r\n    if (direction === 'across') {\r\n      selectAcross(cell);\r\n    } else {\r\n      selectDown(cell);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculates width/height dimension of single cell in px\r\n   * @return {number} dimension\r\n   */\r\n  function getCellDim() {\r\n    const puzTableWidth = puzTable.offsetWidth;\r\n    return Math.floor(puzTableWidth / game.puzzle.rows);\r\n  }\r\n\r\n  /**\r\n   * Sets the variable currentCell to the cell the user clicked in\r\n   * @param {Event} event Mouse click or screen touch event\r\n   */\r\n  function cellClicked(event) {\r\n    const cell = event.target;\r\n    const row = cell.parentElement.rowIndex;\r\n    const col = cell.cellIndex;\r\n    const index = row * columns + col;\r\n    // console.log(cell.cellIndex);\r\n    // console.log(cell.parentElement.rowIndex);\r\n    // console.log(event);\r\n\r\n    if (cell.className === 'black') {\r\n      return;\r\n    }\r\n    if (!idxArray.includes(index)) {\r\n      clearLetters();\r\n    }\r\n    if (currentCell && currentCell === cell) {\r\n      clearLetters();\r\n      acrossWord = !acrossWord;\r\n    }\r\n    idxArray = [];\r\n    currentCell = cell;\r\n    if (acrossWord) {\r\n      selectAcross(cell);\r\n    } else {\r\n      selectDown(cell);\r\n    }\r\n  }\r\n\r\n  /** Clears letters when user changes to a different clue */\r\n  function clearLetters() {\r\n    for (const index of idxArray) {\r\n      if (game.puzzle.grid[index].status === 'locked') continue;\r\n      game.puzzle.grid[index].guess = '';\r\n      const row = Math.floor(index / columns);\r\n      const col = index - row * columns;\r\n      puzTable.firstChild.children[row].children[\r\n          col\r\n      ].firstChild.firstChild.innerText = '';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns an array of indices of cells that make up a word block in\r\n   * the current puzzle.\r\n   * @param {Object} cell Cell in puzzle\r\n   * @param {string} direction Direction (across or down)\r\n   * @return {array} Array of indices that make up a word block\r\n   */\r\n  function getWordBlock(cell, direction) {\r\n    const row = cell.parentElement.rowIndex;\r\n    const col = cell.cellIndex;\r\n    let index = row * columns + col;\r\n    const indexArray = [];\r\n    if (direction === 'across') {\r\n      while (index > row * columns && !game.puzzle.grid[index - 1].black) {\r\n        index--;\r\n      }\r\n      while (index < (row + 1) * columns && !game.puzzle.grid[index].black) {\r\n        indexArray.push(index);\r\n        index++;\r\n      }\r\n    } else {\r\n      while (index >= columns && !game.puzzle.grid[index - columns].black) {\r\n        index -= columns;\r\n      }\r\n      while (\r\n        index < game.puzzle.rows * columns &&\r\n        !game.puzzle.grid[index].black\r\n      ) {\r\n        indexArray.push(index);\r\n        index += columns;\r\n      }\r\n    }\r\n    return indexArray;\r\n  }\r\n\r\n  /**\r\n   * Highlights an across clue and location in puzzle based on which cell\r\n   * the user clicks\r\n   * @param {Object} cell Cell the user clicked\r\n   */\r\n  function selectAcross(cell) {\r\n    const row = cell.parentElement.rowIndex;\r\n    const col = cell.cellIndex;\r\n    const rowOffset = row * columns;\r\n    const index = row * columns + col;\r\n\r\n    clearHighlights();\r\n    idxArray = getWordBlock(cell, 'across');\r\n    currentClue = game.puzzle.grid[idxArray[0]].clueNum;\r\n    for (const clue of acrossClues.children) {\r\n      const clueNumStr = clue.children[0].textContent.split('.')[0];\r\n      if (clueNumStr === currentClue.toString()) {\r\n        clue.classList.add('rangeHighlight', 'cluePop');\r\n        acrossClues.scrollBy({\r\n          top: clue.offsetTop - 100 - acrossClues.scrollTop,\r\n          left: 0,\r\n          behavior: 'smooth',\r\n        });\r\n        singleClue.innerText = clue.children[1].textContent;\r\n        break;\r\n      }\r\n    }\r\n    let currentCol = index - rowOffset;\r\n    let currentCell = cell.parentElement.children[currentCol];\r\n    cell.parentElement.children[idxArray[0] - rowOffset].classList.add(\r\n        'border2pxLeft'\r\n    );\r\n    for (const idx of idxArray) {\r\n      currentCol = idx - rowOffset;\r\n      currentCell = cell.parentElement.children[currentCol];\r\n      currentCell.classList.add('border2pxTop', 'border2pxBottom');\r\n      currentCell.classList.add(\r\n        currentCol === col ? 'currCellHighlight' : 'rangeHighlight'\r\n      );\r\n    }\r\n    cell.parentElement.children[\r\n        idxArray[idxArray.length - 1] - rowOffset\r\n    ].classList.add('border2pxRight');\r\n  }\r\n\r\n  /**\r\n   * Highlights a down clue and location in puzzle based on which cell\r\n   * the user clicks\r\n   * @param {Object} cell Cell the user clicked\r\n   */\r\n  function selectDown(cell) {\r\n    const row = cell.parentElement.rowIndex;\r\n    const col = cell.cellIndex;\r\n    const index = row * columns + col;\r\n\r\n    clearHighlights();\r\n    idxArray = getWordBlock(cell, 'down');\r\n    // get the number of the clue number\r\n    currentClue = game.puzzle.grid[idxArray[0]].clueNum;\r\n    for (const clue of downClues.children) {\r\n      const clueNumStr = clue.children[0].textContent.split('.')[0];\r\n      if (clueNumStr === currentClue.toString()) {\r\n        clue.classList.add('rangeHighlight', 'cluePop');\r\n        downClues.scrollBy({\r\n          top: clue.offsetTop - 100 - downClues.scrollTop,\r\n          left: 0,\r\n          behavior: 'smooth',\r\n        });\r\n        singleClue.innerText = clue.children[1].textContent;\r\n      }\r\n    }\r\n    let currentRow = Math.floor(index / columns);\r\n    let currentCell = puzTable.children[0].children[currentRow].children[col];\r\n    puzTable.children[0].children[Math.floor(idxArray[0] / columns)].children[\r\n        col\r\n    ].classList.add('border2pxTop');\r\n    for (const idx of idxArray) {\r\n      currentRow = Math.floor(idx / columns);\r\n      currentCell = puzTable.children[0].children[currentRow].children[col];\r\n      currentCell.classList.add('border2pxLeft', 'border2pxRight');\r\n      currentCell.classList.add(\r\n        currentRow === row ? 'currCellHighlight' : 'rangeHighlight'\r\n      );\r\n    }\r\n    puzTable.children[0].children[\r\n        Math.floor(idxArray[idxArray.length - 1] / columns)\r\n    ].children[col].classList.add('border2pxBottom');\r\n  }\r\n\r\n  /** Removes clue cell highlighting from all cells */\r\n  function clearHighlights() {\r\n    // console.log(puzTable.children[0]);\r\n    const rowArray = puzTable.children[0].children;\r\n\r\n    for (const row of rowArray) {\r\n      for (const cell of row.children) {\r\n        if (cell.className !== 'black') {\r\n          cell.classList.remove(\r\n              'rangeHighlight',\r\n              'currCellHighlight',\r\n              'border2pxBottom',\r\n              'border2pxRight',\r\n              'border2pxLeft',\r\n              'border2pxTop'\r\n          );\r\n        }\r\n      }\r\n    }\r\n    for (const clue of acrossClues.children) {\r\n      clue.classList.remove('rangeHighlight', 'cluePop');\r\n    }\r\n    for (const clue of downClues.children) {\r\n      clue.classList.remove('rangeHighlight', 'cluePop');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * This function fetches a puzzle based on the user's selection and then\r\n   * calls functions to format and display the puzzle\r\n   * @param {Object} paramObject Object with competitors and puzzle difficulty\r\n   */\r\n  function loadPuzzle(paramObject) {\r\n    document.getElementById('puzTitle').innerText = 'Fetching data...';\r\n\r\n    const difficulty = paramObject.difficulty;\r\n\r\n    let directory = 'puzDirMed.json';\r\n    let year = '1976';\r\n    let month = '01';\r\n    let day = '01';\r\n\r\n    // Stop listening for previous puzzle changes\r\n    if (puzzleId) {\r\n      db.collection('games')\r\n          .doc(puzzleId)\r\n          .onSnapshot(() => {});\r\n    }\r\n\r\n    if (difficulty === 'hard') {\r\n      directory = 'puzDirHard.json';\r\n    } else if (difficulty === 'easy') {\r\n      directory = 'puzDirEasy.json';\r\n    }\r\n\r\n    fetch(directory)\r\n        .then((response) => {\r\n          return response.json();\r\n        })\r\n        .then((dir) => {\r\n          const years = Object.getOwnPropertyNames(dir);\r\n          year = years[Math.floor(Math.random() * years.length)];\r\n          const months = Object.getOwnPropertyNames(dir[year]);\r\n          month = months[Math.floor(Math.random() * months.length)];\r\n          const days = dir[year][month];\r\n          day = days[Math.floor(Math.random() * days.length)];\r\n        })\r\n        .then(() => {\r\n          const baseUrl =\r\n            'https://raw.githubusercontent.com/doshea/nyt_crosswords/master';\r\n          const url = `${baseUrl}/${year}/${month}/${day}`;\r\n          fetch(url)\r\n              .then((response) => {\r\n                return response.json();\r\n              })\r\n              .then((obj) => {\r\n                parsePuzzle(obj);\r\n                saveNewPuzzle(paramObject);\r\n                showPuzzle();\r\n                location.hash = '#puzzle';\r\n              })\r\n              .catch((error) => {\r\n                console.error('Error fetching puzzle: ', error);\r\n              });\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error fetching puzzle date: ', error);\r\n        });\r\n  }\r\n\r\n  /**\r\n   * This function fetches an active puzzle based on the user's selection\r\n   * and then calls functions to format and display the puzzle\r\n   * @param {String} newPuzzleId Firestore game (puzzle) id\r\n   */\r\n  function fetchPuzzle(newPuzzleId) {\r\n    document.getElementById('puzTitle').innerText = 'Fetching data...';\r\n\r\n    const db = window.firebase.firestore();\r\n    const docRef = db.collection('games').doc(newPuzzleId);\r\n\r\n    // Stop listening for previous puzzle changes\r\n    if (puzzleId) {\r\n      db.collection('games')\r\n          .doc(puzzleId)\r\n          .onSnapshot(() => {});\r\n    }\r\n\r\n    docRef.onSnapshot(\r\n        (doc) => {\r\n          game = doc.data();\r\n          if (game.status === 'started') {\r\n            myOpponentUid =\r\n            game.initiator.uid === currentUser.uid ?\r\n            game.opponent.uid :\r\n            game.initiator.uid;\r\n            columns = game.puzzle.cols;\r\n            myTurn = game.nextTurn !== myOpponentUid;\r\n            updateScoreHighlighting();\r\n          }\r\n          puzzleId = newPuzzleId;\r\n          showPuzzle();\r\n          location.hash = '#puzzle';\r\n        },\r\n        (error) => {\r\n          console.error('Error getting puzzle: ', error);\r\n        }\r\n    );\r\n  }\r\n\r\n  /** Utility function to update score display */\r\n  function updateScoreHighlighting() {\r\n    scores.children[0].classList.remove(\r\n      myTurn ? 'bgColorTransWhite' : 'bgColorTransGold'\r\n    );\r\n    scores.children[0].classList.add(\r\n      myTurn ? 'bgColorTransGold' : 'bgColorTransWhite'\r\n    );\r\n    scores.children[2].classList.remove(\r\n      myTurn ? 'bgColorTransGold' : 'bgColorTransWhite'\r\n    );\r\n    scores.children[2].classList.add(\r\n      myTurn ? 'bgColorTransWhite' : 'bgColorTransGold'\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Parse the fetched puzzle into a more compact form\r\n   * @param {Object} puzzle Puzzle object returned from fetch\r\n   */\r\n  function parsePuzzle(puzzle) {\r\n    const rows = puzzle.size.rows;\r\n    const cols = puzzle.size.cols;\r\n    game = {};\r\n    game.emptySquares = rows * cols;\r\n    game.puzzle = {};\r\n    game.puzzle.cols = cols;\r\n    game.puzzle.rows = rows;\r\n    game.puzzle.author = puzzle.author;\r\n    game.puzzle.clues = puzzle.clues;\r\n    game.puzzle.copyright = puzzle.copyright;\r\n    game.puzzle.date = puzzle.date;\r\n    game.puzzle.dow = puzzle.dow;\r\n    game.puzzle.editor = puzzle.editor;\r\n    game.puzzle.notepad = puzzle.notepad;\r\n    game.puzzle.title = puzzle.title;\r\n    game.puzzle.completedClues = {};\r\n    game.puzzle.completedClues.across = [];\r\n    game.puzzle.completedClues.down = [];\r\n    game.puzzle.grid = [];\r\n    for (let i = 0; i < puzzle.grid.length; i++) {\r\n      game.puzzle.grid[i] = {};\r\n      if (puzzle.grid[i] === '.') {\r\n        game.puzzle.grid[i].black = true;\r\n        game.emptySquares--;\r\n      } else {\r\n        game.puzzle.grid[i].black = false;\r\n        game.puzzle.grid[i].value = puzzle.grid[i];\r\n        game.puzzle.grid[i].clueNum =\r\n          puzzle.gridnums[i] === 0 ? '' : puzzle.gridnums[i];\r\n        game.puzzle.grid[i].status = 'free';\r\n        game.puzzle.grid[i].circle = puzzle.circles && puzzle.circles[i] === 1;\r\n      }\r\n    }\r\n    columns = cols;\r\n    console.log(game.puzzle);\r\n  }\r\n\r\n  /** Saves new puzzle to firebase\r\n   * @param {Object} paramObject Id and difficulty object passed to loadPuzzle\r\n   * from games.js\r\n   */\r\n  function saveNewPuzzle(paramObject) {\r\n    const initiatorUid = paramObject.initiator.uid;\r\n    const iDisplayName = paramObject.initiator.displayName;\r\n    myOpponentUid = paramObject.opponent.uid;\r\n    const oDisplayName = paramObject.opponent.displayName;\r\n\r\n    myTurn = true;\r\n    game.initiator = {};\r\n    game.initiator.uid = initiatorUid;\r\n    game.initiator.displayName = iDisplayName;\r\n    game.initiator.bgColor = 'bgTransRed';\r\n    game.initiator.score = 0;\r\n    game.initiator.squaresWon = [];\r\n    game.initiator.errors = 0;\r\n    game.opponent = {};\r\n    game.opponent.uid = myOpponentUid;\r\n    game.opponent.displayName = oDisplayName;\r\n    game.opponent.bgColor = 'bgTransBlue';\r\n    game.opponent.score = 0;\r\n    game.opponent.squaresWon = [];\r\n    game.opponent.errors = 0;\r\n    game.difficulty = paramObject.difficulty;\r\n    game.start = firebase.firestore.FieldValue.serverTimestamp();\r\n    game.status = 'started';\r\n    game.winner = null;\r\n    game.nextTurn = initiatorUid;\r\n    db.collection('games')\r\n        .add(game)\r\n        .then((docRef) => {\r\n          console.log('game written to firestore with docRef: ', docRef);\r\n          puzzleId = docRef.id;\r\n          db.collection('games')\r\n              .doc(puzzleId)\r\n              .onSnapshot(\r\n                  (doc) => {\r\n                    game = doc.data();\r\n                    myTurn = game.nextTurn !== myOpponentUid;\r\n                    showPuzzle();\r\n                  },\r\n                  (error) => {\r\n                    console.error('Error getting puzzle: ', error);\r\n                  }\r\n              );\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error writing file to firestore: ', error);\r\n        });\r\n  }\r\n\r\n  /** Saves puzzle to firebase */\r\n  function savePuzzle() {\r\n    db.collection('games')\r\n        .doc(puzzleId)\r\n        .set(game, {merge: true})\r\n        .catch((error) => {\r\n          console.error('Error saving to firebase: ', error);\r\n        });\r\n  }\r\n\r\n  /** Removes puzzle from DOM */\r\n  function clearPuzzle() {\r\n    puzTitle.innerText = 'Puzzle info will appear here';\r\n    // clear out old puzzle and clues\r\n    puzTable.innerHTML = '';\r\n    puzAuthor.innerText = '';\r\n    puzNotepad.classList.add('displayNone');\r\n    puzCopy.innerHTML = '';\r\n    clueContainer.classList.add('displayNone');\r\n    splash.classList.remove('displayNone');\r\n    acrossClues.innerHTML = '';\r\n    downClues.innerHTML = '';\r\n    singleClue.innerText = 'Select in the puzzle to reveal clue';\r\n  }\r\n\r\n  /** Resizes puzzle based on available space */\r\n  function resizePuzzle() {\r\n    if (puzTable.children.length === 0) return;\r\n    // console.log(puzTable.children[0]);\r\n    const cellDim = getCellDim();\r\n    const tableDim = cellDim * game.puzzle.rows;\r\n    const rowArray = puzTable.children[0].children;\r\n\r\n    for (const row of rowArray) {\r\n      row.style.width = tableDim + 'px';\r\n      const cellArray = row.children;\r\n      for (const cell of cellArray) {\r\n        cell.style.width = cellDim + 'px';\r\n        cell.style.height = cellDim + 'px';\r\n      }\r\n    }\r\n    if (currentCell) {\r\n      if (acrossWord) {\r\n        selectAcross(currentCell);\r\n      } else {\r\n        selectDown(currentCell);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Helper function for toggling drawer */\r\n  function toggleDrawer() {\r\n    document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();\r\n  }\r\n\r\n  /**\r\n   * Play currentUser's turn. Executed when the player clicks the enter\r\n   * button\r\n   */\r\n  function playWord() {\r\n    if (location.hash === '#puzzle' && !myTurn) {\r\n      alert('Your opponent hasn\\'t played their turn yet!');\r\n      return;\r\n    }\r\n    if (incomplete()) return;\r\n    if (correctAnswer()) {\r\n      const direction = acrossWord ? 'across' : 'down';\r\n      const clueNumber = game.puzzle.grid[idxArray[0]].clueNum;\r\n      game.puzzle.completedClues[direction].push(clueNumber);\r\n      document\r\n          .getElementById(direction + clueNumber)\r\n          .classList.add('colorLightGray');\r\n      for (const index of idxArray) {\r\n        const gridElement = game.puzzle.grid[index];\r\n        game.puzzle.grid[index] = setCellStatus(index, gridElement);\r\n      }\r\n    }\r\n    game.nextTurn = myOpponentUid;\r\n    myTurn = !myTurn;\r\n    savePuzzle();\r\n  }\r\n\r\n  /**\r\n   * Checks if array of cells has a letter in each square\r\n   * @return {boolean} true if word is incomplete, false otherwise\r\n   */\r\n  function incomplete() {\r\n    for (const i of idxArray) {\r\n      if (!game.puzzle.grid[i].guess || game.puzzle.grid[i].guess === '') {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Checks if array of cells is filled in correctly\r\n   * @return {boolean} true if correct, false otherwise\r\n   */\r\n  function correctAnswer() {\r\n    for (const index of idxArray) {\r\n      const gridElement = game.puzzle.grid[index];\r\n      if (gridElement.guess !== gridElement.value) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Sets values for gridElement based on currentUser play\r\n   * @param {number} index index of cell\r\n   * @param {Object} gridElement game.puzzle grid array object\r\n   * @return {Object} Updated grid element object\r\n   */\r\n  function setCellStatus(index, gridElement) {\r\n    const player =\r\n      game.initiator.uid === currentUser.uid ? 'initiator' : 'opponent';\r\n    if (gridElement.status === 'locked') {\r\n      game[player].score += scoreValues[gridElement.value];\r\n      return gridElement;\r\n    }\r\n    game[player].score += scoreCell(index);\r\n    game[player].squaresWon.push(index);\r\n    game.emptySquares--;\r\n    gridElement.bgColor = game[player].bgColor;\r\n    gridElement.status = 'locked';\r\n    return gridElement;\r\n  }\r\n\r\n  /**\r\n   * Adds to score if orthogonal word is completed by this play\r\n   * @param {number} index index of cell\r\n   * @return {number} additional score due to completion of orthogonal word\r\n   */\r\n  function scoreCell(index) {\r\n    const row = Math.floor(index / columns);\r\n    const col = index - row * columns;\r\n    const cell = puzTable.children[0].children[row].children[col];\r\n    const direction = acrossWord ? 'down' : 'across';\r\n    const wordBlock = getWordBlock(cell, direction);\r\n    let addedScore = 0;\r\n\r\n    for (const idx of wordBlock) {\r\n      if (idx === index) {\r\n        addedScore += 2 * scoreValues[game.puzzle.grid[idx].value];\r\n      } else if (game.puzzle.grid[idx].status === 'locked') {\r\n        addedScore += scoreValues[game.puzzle.grid[idx].value];\r\n      } else {\r\n        return scoreValues[game.puzzle.grid[index].value];\r\n      }\r\n    }\r\n    const clueNumber = game.puzzle.grid[wordBlock[0]].clueNum;\r\n    game.puzzle.completedClues[direction].push(clueNumber);\r\n    return addedScore;\r\n  }\r\n\r\n  /**\r\n   * Adds a letter to the puzzle from physical or virtual keyboard event and\r\n   * moves forward one space\r\n   * @param {Event} event Keyboard or touch event from physical or virtual\r\n   * keyboard\r\n   */\r\n  function enterLetter(event) {\r\n    if (event.keyCode === 13) {\r\n      playWord();\r\n      return;\r\n    }\r\n    let letter;\r\n    if (event.key) {\r\n      letter = event.key;\r\n    } else {\r\n      let node = event.target;\r\n      while (node.classList[0] !== 'kbButton') {\r\n        node = node.parentNode;\r\n      }\r\n      letter = node.childNodes[0].childNodes[0].data;\r\n    }\r\n    if (letter && letter.toLowerCase() === 'backspace') {\r\n      undoEntry();\r\n      return;\r\n    }\r\n    // if (letter && letter.toLowerCase() === 'enter') {\r\n    //   playWord();\r\n    //   return;\r\n    // }\r\n    if (!letter || !letter.match(/^[a-zA-Z]$/)) return;\r\n    if (currentCell) {\r\n      let row = currentCell.parentElement.rowIndex;\r\n      let col = currentCell.cellIndex;\r\n      const index = row * columns + col;\r\n      const nextCellIndex = idxArray.indexOf(index) + 1;\r\n      const localIdxArray = idxArray\r\n          .slice(nextCellIndex)\r\n          .concat(idxArray.slice(0, nextCellIndex));\r\n      const letterDiv = document.createElement('div');\r\n      // console.log(idxArray);\r\n      // console.log(localIdxArray);\r\n\r\n      if (game.puzzle.grid[index].status === 'locked') {\r\n        // alert('Sorry, that square is locked by a previous answer');\r\n        return;\r\n      }\r\n      game.puzzle.grid[index].guess = letter.toUpperCase();\r\n      letterDiv.appendChild(document.createTextNode(letter.toUpperCase()));\r\n      letterDiv.classList.add('marginAuto');\r\n      currentCell.children[0].replaceChild(\r\n          letterDiv,\r\n          currentCell.children[0].children[0]\r\n      );\r\n      currentCell.classList.remove('currCellHighlight');\r\n      currentCell.classList.add('rangeHighlight');\r\n      for (const idx of localIdxArray) {\r\n        if (game.puzzle.grid[idx].status !== 'locked') {\r\n          row = Math.floor(idx / columns);\r\n          col = idx - row * columns;\r\n          currentCell = puzTable.children[0].children[row].children[col];\r\n          currentCell.classList.remove('rangeHighlight');\r\n          currentCell.classList.add('currCellHighlight');\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Removes letter (if present) from current cell and moves\r\n   * backward one space\r\n   */\r\n  function undoEntry() {\r\n    if (currentCell) {\r\n      let row = currentCell.parentElement.rowIndex;\r\n      let col = currentCell.cellIndex;\r\n      const index = row * columns + col;\r\n      // reverse copy idxArray so we go backwards instead of forwards\r\n      let localIdxArray = [];\r\n      for (let i = 0, j = idxArray.length; i < idxArray.length; i++, j--) {\r\n        localIdxArray[i] = idxArray[j - 1];\r\n      }\r\n      const nextCellIndex = localIdxArray.indexOf(index) + 1;\r\n      localIdxArray = localIdxArray\r\n          .slice(nextCellIndex)\r\n          .concat(localIdxArray.slice(0, nextCellIndex));\r\n      const letterDiv = document.createElement('div');\r\n      // console.log(idxArray);\r\n      // console.log(localIdxArray);\r\n\r\n      if (game.puzzle.grid[index].status === 'locked') {\r\n        // alert('Sorry, that square is locked by a previous answer');\r\n        return;\r\n      }\r\n      letterDiv.appendChild(document.createTextNode(''));\r\n      letterDiv.classList.add('marginAuto');\r\n      currentCell.children[0].replaceChild(\r\n          letterDiv,\r\n          currentCell.children[0].children[0]\r\n      );\r\n      currentCell.classList.remove('currCellHighlight');\r\n      currentCell.classList.add('rangeHighlight');\r\n      for (const idx of localIdxArray) {\r\n        if (game.puzzle.grid[idx].status !== 'locked') {\r\n          row = Math.floor(idx / columns);\r\n          col = idx - row * columns;\r\n          currentCell = puzTable.children[0].children[row].children[col];\r\n          currentCell.classList.remove('rangeHighlight');\r\n          currentCell.classList.add('currCellHighlight');\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Concede the game immediately */\r\n  function concede() {\r\n    const me = currentUser.uid === game.initiator.uid ?\r\n        'initiator' : 'opponent';\r\n    const they = me === 'initiator' ? 'opponent' : 'initiator';\r\n\r\n    game.emptySquares = 0;\r\n    for (const square of game.puzzle.grid) {\r\n      if (square.status && square.status === 'free') {\r\n        square.status = 'locked';\r\n        square.guess = square.value;\r\n        square.bgColor = game[they].bgColor;\r\n        game[they].score += 1;\r\n      }\r\n    }\r\n    savePuzzle();\r\n  }\r\n\r\n  concessionBtn.addEventListener('click', concede);\r\n  document.addEventListener('keyup', enterLetter);\r\n  window.addEventListener('resize', resizePuzzle);\r\n  const keyList = keyboard.getElementsByClassName('kbButton');\r\n  for (const node of keyList) {\r\n    node.addEventListener('click', enterLetter);\r\n  }\r\n  document.getElementById('backspace').addEventListener('click', undoEntry);\r\n  document.getElementById('enter').addEventListener('click', playWord);\r\n  document\r\n      .getElementById('closeDrawer')\r\n      .addEventListener('click', toggleDrawer);\r\n  screenToggle.addEventListener('click', toggleScreen);\r\n\r\n  /** Toggle between window and full screen */\r\n  function toggleScreen() {\r\n    if (window.screenfull.enabled) {\r\n      window.screenfull.toggle();\r\n    }\r\n  }\r\n\r\n  if (window.screenfull.enabled) {\r\n    window.screenfull.on('change', () => {\r\n      screenToggle.innerText = window.screenfull.isFullscreen ?\r\n        'fullscreen_exit' :\r\n        'fullscreen';\r\n    });\r\n  }\r\n\r\n  /** Init in case we need it */\r\n  function init() {\r\n    console.log('The dude abides!');\r\n  }\r\n\r\n  return {\r\n    // initPicker: initPicker,\r\n    init: init,\r\n    loadPuzzle: loadPuzzle,\r\n    fetchPuzzle: fetchPuzzle,\r\n    clearPuzzle: clearPuzzle,\r\n  };\r\n})();\r\n\r\npuzzleWorker.init();\r\n","/* eslint-env es6, browser */\r\n(function() {\r\n  window.addEventListener('load', function() {\r\n    initApp();\r\n  });\r\n\r\n  /** Initialize after document loads */\r\n  function initApp() {\r\n    const authButton = document.getElementById('authButton');\r\n    const authContainer = document.getElementById('firebaseuiAuthContainer');\r\n    const profileName = document.getElementById('profileName');\r\n    const avatar = document.getElementById('avatar');\r\n    const puzTable = document.getElementById('puzTable');\r\n    const clueContainer = document.getElementById('clueContainer');\r\n    const kbContainer = document.getElementById('kbContainer');\r\n    const splash = document.getElementById('splash');\r\n    const firebase = window.firebase;\r\n    const firebaseui = window.firebaseui;\r\n    // const db = firebase.firestore;\r\n    // Initialize the FirebaseUI Widget using Firebase.\r\n    const ui = new firebaseui.auth.AuthUI(firebase.auth());\r\n    let uid;\r\n    let userStatusDatabaseRef;\r\n    let userStatusFirestoreRef;\r\n\r\n    const uiConfig = {\r\n      signInSuccessUrl: './',\r\n      signInOptions: [\r\n        // Leave the lines as is for the providers you want to offer your users.\r\n        firebase.auth.GoogleAuthProvider.PROVIDER_ID,\r\n        firebase.auth.EmailAuthProvider.PROVIDER_ID,\r\n        // firebase.auth.FacebookAuthProvider.PROVIDER_ID,\r\n        // firebase.auth.TwitterAuthProvider.PROVIDER_ID,\r\n        // firebase.auth.GithubAuthProvider.PROVIDER_ID,\r\n        // firebase.auth.PhoneAuthProvider.PROVIDER_ID,\r\n      ],\r\n      // Terms of service url.\r\n      tosUrl: './#tos',\r\n      // Privacy policy url.\r\n      privacyPolicyUrl: './#privacy',\r\n    };\r\n\r\n    // We'll create two constants which we will write to\r\n    // the Realtime database when this device is offline\r\n    // or online.\r\n    const isOfflineForDatabase = {\r\n      state: 'offline',\r\n      lastChanged: firebase.database.ServerValue.TIMESTAMP,\r\n    };\r\n    const isOnlineForDatabase = {\r\n      state: 'online',\r\n      lastChanged: firebase.database.ServerValue.TIMESTAMP,\r\n    };\r\n    // Firestore uses a different server timestamp value, so we'll\r\n    // create two more constants for Firestore state.\r\n    const isOfflineForFirestore = {\r\n      state: 'offline',\r\n      lastChanged: firebase.firestore.FieldValue.serverTimestamp(),\r\n    };\r\n    const isOnlineForFirestore = {\r\n      state: 'online',\r\n      lastChanged: firebase.firestore.FieldValue.serverTimestamp(),\r\n    };\r\n\r\n    // The start method will wait until the DOM is loaded.\r\n    ui.start('#firebaseuiAuthContainer', uiConfig);\r\n\r\n    firebase.auth().onAuthStateChanged((user) => {\r\n      if (user) {\r\n        // User is signed in.\r\n        uid = user.uid;\r\n        isOnlineForFirestore.displayName = user.displayName;\r\n        isOnlineForFirestore.photoURL = user.photoURL;\r\n        isOnlineForFirestore.providerId = user.providerData[0].providerId;\r\n        isOnlineForFirestore.uid = uid;\r\n        isOnlineForFirestore.privateData = {\r\n          email: user.email,\r\n          emailVerified: user.emailVerified,\r\n          phoneNumber: user.phoneNumber,\r\n          providerData: user.providerData,\r\n          providerId: user.providerId,\r\n        };\r\n\r\n        authButton.textContent = 'sign out';\r\n        profileName.textContent = user.displayName;\r\n        avatar.src =\r\n          user.photoURL ? user.photoURL : 'images/avatar_circle_black.png';\r\n\r\n        // Create a reference to this user's specific status node.\r\n        // This is where we will store data about being online/offline.\r\n        userStatusDatabaseRef = firebase.database().ref(`/users/${uid}`);\r\n        userStatusFirestoreRef = firebase.firestore().doc(`/users/${uid}`);\r\n\r\n        firebase.database().ref('.info/connected').on('value', (snapshot) => {\r\n          if (snapshot.val() === false) {\r\n            // Instead of simply returning, we'll also set Firestore's state\r\n            // to \"offline\". This ensures that our Firestore cache is aware\r\n            // of the switch to \"offline.\"\r\n            userStatusFirestoreRef.set(isOfflineForFirestore, {merge: true});\r\n            return;\r\n          }\r\n          userStatusDatabaseRef.onDisconnect()\r\n              .set(isOfflineForDatabase).then(() => {\r\n                userStatusDatabaseRef.set(isOnlineForDatabase);\r\n                userStatusFirestoreRef.set(isOnlineForFirestore, {merge: true});\r\n              });\r\n        });\r\n        authContainer.classList.add('displayNone');\r\n      } else {\r\n        // User is signed out.\r\n        authButton.textContent = 'sign in';\r\n        authContainer.classList.remove('displayNone');\r\n        profileName.textContent = 'N. E. Person';\r\n        avatar.src = 'images/avatar_circle_black.png';\r\n      }\r\n    }, function(error) {\r\n      console.log(error);\r\n    });\r\n\r\n    authButton.addEventListener('click', () => {\r\n      document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();\r\n      if (authButton.textContent === 'sign out') {\r\n        window.puzzleGames.clearLists();\r\n        userStatusFirestoreRef\r\n            .set(isOfflineForFirestore, {merge: true}).then(() => {\r\n              firebase.auth().signOut();\r\n            }).then(() => {\r\n              // Sign-out successful.\r\n              uid = undefined;\r\n              userStatusDatabaseRef = undefined;\r\n              userStatusFirestoreRef = undefined;\r\n              puzTable.classList.add('displayNone');\r\n              clueContainer.classList.add('displayNone');\r\n              kbContainer.classList.add('displayNone');\r\n              splash.classList.remove('displayNone');\r\n            }).catch((error) => {\r\n              console.log(error);\r\n            });\r\n      } else {\r\n        puzTable.classList.add('displayNone');\r\n        clueContainer.classList.add('displayNone');\r\n        kbContainer.classList.add('displayNone');\r\n        splash.classList.remove('displayNone');\r\n        location.hash = '#signin';\r\n      }\r\n    });\r\n  }\r\n})();\r\n","/* eslint-env es6, browser */\r\nconst puzzleGames = (function(document, window) {\r\n  const querySelector = document.querySelector.bind(document);\r\n  const gamesDialog = querySelector('#gamesDialog');\r\n  const startGameButton = querySelector('#startGameButton');\r\n  const headerSignin = querySelector('#headerSignin');\r\n  // const turnIndicator = querySelector('#turnIndicator');\r\n  const gameOverHeading = querySelector('#gameOverHeading');\r\n  const winMessage = querySelector('#winMessage');\r\n  const opponentHeading = querySelector('#opponentHeading');\r\n  const opponentList = querySelector('#opponentList');\r\n  const radioEasy = querySelector('#radioEasy');\r\n  const radioMed = querySelector('#radioMed');\r\n  const radioHard = querySelector('#radioHard');\r\n  const dialogListContainer = querySelector('#dialogList');\r\n  const activeGamesContainer = querySelector('#activeGamesContainer');\r\n  const pastGamesContainer = querySelector('#pastGamesContainer');\r\n  const dialogPolyfill = window.dialogPolyfill || {};\r\n  const firebase = window.firebase;\r\n\r\n  let currentUser = firebase.auth().currentUser;\r\n  // let difficulty = 'medium';\r\n  let dialogList = '';\r\n  let activeGamesHtml = '';\r\n  let pastGamesHtml = '';\r\n  let allUsers = {};\r\n  // let pastGames = {};\r\n  // holder variable for function\r\n\r\n  firebase.auth().onAuthStateChanged((user) => {\r\n    currentUser = user;\r\n    // fillLists();\r\n    if (user) {\r\n      headerSignin.classList.add('displayNone');\r\n    } else {\r\n      headerSignin.classList.remove('displayNone');\r\n      // turnIndicator.classList.add('displayNone');\r\n    }\r\n  });\r\n\r\n  if (!gamesDialog.showModal) {\r\n    dialogPolyfill.registerDialog(gamesDialog);\r\n  }\r\n\r\n  startGameButton.addEventListener('click', initNewGame);\r\n  headerSignin.addEventListener('click', () => {\r\n    location.hash = '#signin';\r\n  });\r\n\r\n  gamesDialog.querySelector('.close').addEventListener('click',\r\n      closeGamesDialog);\r\n\r\n  /** Reset radio buttons and close dialog */\r\n  function closeGamesDialog() {\r\n    radioMed.removeAttribute('checked');\r\n    radioHard.removeAttribute('checked');\r\n    radioEasy.setAttribute('checked', true);\r\n    gamesDialog.close();\r\n  }\r\n\r\n  /** Start a new game or send user to the login page */\r\n  function initNewGame() {\r\n    if (currentUser) {\r\n      // user is logged in\r\n      gameOverHeading.classList.add('displayNone');\r\n      winMessage.classList.add('displayNone');\r\n      gamesDialog.firstChild.classList.add('padding0', 'height100pct');\r\n      opponentHeading.classList.remove('displayNone');\r\n      opponentList.classList.remove('displayNone');\r\n      const replayButton = querySelector('#replayButton');\r\n      if (replayButton) {\r\n        try {\r\n          gamesDialog.firstChild.removeChild(replayButton);\r\n        } catch (err) {\r\n          // do nothing.  replayButton not attached\r\n        }\r\n      }\r\n      gamesDialog.classList.add('height80pct');\r\n      gamesDialog.showModal();\r\n    } else {\r\n      // user is not logged in\r\n      location.hash = '#signin';\r\n    }\r\n  }\r\n\r\n  /** Subscribe to firestore listeners */\r\n  function subscribe() {\r\n    firebase.firestore().collection('users')\r\n        .onSnapshot((snapshot) => loadUserList(snapshot), (error) => {\r\n          console.error('Error getting users: ', error);\r\n        });\r\n    firebase.firestore().collection('games')\r\n        .onSnapshot((snapshot) => loadGames(snapshot), (error) => {\r\n          console.error('Error getting games: ', error);\r\n        });\r\n  }\r\n\r\n  /** Unsubscribe from firestore listeners */\r\n  function unsubscribe() {\r\n    firebase.firestore().collection('users').onSnapshot(() => {});\r\n    firebase.firestore().collection('games').onSnapshot(() => {});\r\n  }\r\n\r\n  /**\r\n   * Snapshot of firebase 'user' collection\r\n   * @param {Object} snapshot Collection of users\r\n   */\r\n  function loadUserList(snapshot) {\r\n    if (!currentUser) return;\r\n    dialogListContainer.innerHTML = '';\r\n    dialogListContainer.removeEventListener('click', loadNewGame);\r\n    dialogList = '';\r\n    if (snapshot.empty) {\r\n      console.warn('No users exist yet.');\r\n      return;\r\n    }\r\n    const usersObj = {};\r\n    snapshot.docs.forEach((doc) => {\r\n      const uid = doc.id;\r\n      const user = doc.data();\r\n      usersObj[uid] = user;\r\n      // doc.data() is never undefined for query doc snapshots\r\n      // console.log(doc.id, ' => ', doc.data());\r\n      if (uid !== currentUser.uid) {\r\n        let avatar =\r\n          `<i class='material-icons mdl-list__item-avatar'>person</i>`;\r\n        if (user.photoURL) {\r\n          avatar =\r\n`<span class='picContainer material-icons mdl-list__item-avatar'>\r\n  <div>\r\n    <img class='photoCrop' src='${user.photoURL}' alt='profile picture'>\r\n  </div>\r\n</span>`;\r\n        }\r\n        dialogList +=\r\n`<li id='${uid}' class='mdl-list__item mdl-list__item--two-line cursorPointer'>\r\n   <span class='mdl-list__item-primary-content'>\r\n     ${avatar}\r\n     <span>${user.displayName}</span>\r\n     <span class='mdl-list__item-sub-title'>\r\n       ${user.providerId.split('.')[0]}\r\n     </span>\r\n   </span>\r\n   <span class='mdl-list__item-secondary-content'>\r\n     <span class='mdl-list__item-secondary-info'>Play</span>\r\n     <i class='material-icons'>grid_on</i>\r\n   </span>\r\n </li>`;\r\n      }\r\n    });\r\n    allUsers = usersObj;\r\n    // console.log(dialogList);\r\n    dialogListContainer.innerHTML = dialogList;\r\n    dialogListContainer.addEventListener('click', loadNewGame);\r\n  }\r\n\r\n  /**\r\n   * Snapshot of firebase 'games' collection\r\n   * @param {Object} snapshot Collection of games\r\n   */\r\n  function loadGames(snapshot) {\r\n    if (!currentUser) return;\r\n    activeGamesContainer.innerHTML = 'No active games yet. Start one!';\r\n    pastGamesContainer.innerHTML = 'No completed games yet';\r\n    activeGamesContainer.removeEventListener('click', loadActiveGame);\r\n    activeGamesHtml = '';\r\n    pastGamesHtml = '';\r\n    if (snapshot.empty) {\r\n      console.warn('No games exist yet.');\r\n      return;\r\n    }\r\n    snapshot.docs.forEach((doc) => {\r\n      // doc.data() is never undefined for query doc snapshots\r\n      // console.log(doc.id, ' => ', doc.data());\r\n      const game = doc.data();\r\n      let avatar = `<i class='material-icons mdl-list__item-avatar'>person</i>`;\r\n      if (game.status === 'started' &&\r\n        (game.initiator.uid === currentUser.uid ||\r\n          game.opponent.uid === currentUser.uid)) {\r\n        const myOpponent = game.initiator.uid === currentUser.uid ?\r\n          game.opponent : game.initiator;\r\n        const opponentPhoto = allUsers[myOpponent.uid] &&\r\n          allUsers[myOpponent.uid].photoURL;\r\n        if (opponentPhoto) {\r\n          avatar =\r\n`<span class='picContainer material-icons mdl-list__item-avatar'>\r\n  <div>\r\n    <img class='photoCrop' src='${opponentPhoto}' alt='profile picture'>\r\n  </div>\r\n</span>`;\r\n        }\r\n        activeGamesHtml +=\r\n// eslint-disable-next-line max-len\r\n`<li id='${doc.id}' class='mdl-list__item mdl-list__item--two-line cursorPointer'>\r\n   <span class='mdl-list__item-primary-content'>\r\n     ${avatar}\r\n     <span>${myOpponent.displayName}</span>\r\n     <span class='mdl-list__item-sub-title'>\r\n       ${currentUser.uid === game.nextTurn ? 'Your' : 'Their'} turn\r\n     </span>\r\n   </span>\r\n   <span class='mdl-list__item-secondary-content'>\r\n     <span class='mdl-list__item-secondary-info'>Play</span>\r\n     <i class='material-icons'>grid_on</i>\r\n   </span>\r\n </li>`;\r\n      } else if (game.initiator.uid === currentUser.uid ||\r\n        game.opponent.uid === currentUser.uid) {\r\n        const myOpponent = game.initiator.uid === currentUser.uid ?\r\n          game.opponent : game.initiator;\r\n        let result = 'Game cancelled';\r\n        if (game.status === 'finished') {\r\n          result = currentUser.uid === game.winner ?\r\n            'You won!!' :\r\n            'They won';\r\n        } else if (game.status === 'abandoned') {\r\n          result = 'Game abandoned';\r\n        }\r\n        // pastGames[doc.id] = {};\r\n        // pastGames[doc.id].difficulty = game.difficulty;\r\n        const opponentPhoto = allUsers[myOpponent.uid] &&\r\n          allUsers[myOpponent.uid].photoURL;\r\n        if (opponentPhoto) {\r\n          avatar =\r\n`<span class='picContainer material-icons mdl-list__item-avatar'>\r\n  <div>\r\n    <img class='photoCrop' src='${opponentPhoto}' alt='profile picture'>\r\n  </div>\r\n</span>`;\r\n        }\r\n        pastGamesHtml +=\r\n`<li id='${doc.id}' class='mdl-list__item mdl-list__item--two-line\\\r\n cursorPointer'>\r\n   <span class='mdl-list__item-primary-content'>\r\n     ${avatar}\r\n     <span>${myOpponent.displayName}</span>\r\n     <span class='mdl-list__item-sub-title'>${result}</span>\r\n   </span>\r\n </li>`;\r\n      }\r\n    });\r\n    // console.log(dialogList);\r\n    activeGamesContainer.innerHTML =\r\n      activeGamesHtml === '' ?\r\n        'No active games yet. Start one!' :\r\n        activeGamesHtml;\r\n    pastGamesContainer.innerHTML =\r\n      pastGamesHtml === '' ? 'No completed games yet' : pastGamesHtml;\r\n    activeGamesContainer.addEventListener('click', loadActiveGame);\r\n    pastGamesContainer.addEventListener('click', showPastGame);\r\n  }\r\n\r\n  /**\r\n   * Show dialog for user to decide if they want to replay the opponent\r\n   * @param {Object} event Click event from replayButton in dialog\r\n   */\r\n  function showPastGame(event) {\r\n    let eventTarget = event.target;\r\n    while (!eventTarget.id) {\r\n      if (eventTarget.nodeName.toLowerCase() === 'ul') return;\r\n      eventTarget = eventTarget.parentElement;\r\n    }\r\n    window.puzzleWorker.fetchPuzzle(eventTarget.id);\r\n  }\r\n\r\n  /**\r\n   * Load game based on user selection\r\n   * @param {Object} event Click event from dialogListContainer\r\n   */\r\n  function loadNewGame(event) {\r\n    let target = event.target.parentElement;\r\n    if (target.id === '') {\r\n      target = target.parentElement;\r\n    }\r\n    let difficulty =\r\n      radioMed.parentElement.classList.contains('is-checked') ?\r\n        'medium' : 'easy';\r\n    difficulty =\r\n      radioHard.parentElement.classList.contains('is-checked') ?\r\n        'hard' : difficulty;\r\n    closeGamesDialog();\r\n\r\n    window.puzzleWorker.loadPuzzle({\r\n      initiator: {\r\n        uid: currentUser.uid,\r\n        displayName: currentUser.displayName,\r\n      },\r\n      opponent: {\r\n        uid: target.id,\r\n        displayName: allUsers[target.id].displayName,\r\n      },\r\n      difficulty: difficulty,\r\n    });\r\n    // unsubscribe();\r\n    // location.hash = '#puzzle';\r\n  }\r\n\r\n  /**\r\n   * Show dialog for user to decide if they want to replay the opponent\r\n   * @param {Object} game Previous game versus the opponent\r\n   * @param {string} result Message about who won\r\n   */\r\n  function showReplayDialog(game, result) {\r\n    winMessage.innerText = result;\r\n    gameOverHeading.classList.remove('displayNone');\r\n    winMessage.classList.remove('displayNone');\r\n    opponentHeading.classList.add('displayNone');\r\n    opponentList.classList.add('displayNone');\r\n    gamesDialog.classList.remove('height80pct');\r\n    gamesDialog.firstChild.classList.remove('padding0', 'height100pct');\r\n    let replayButton = querySelector('#replayButton');\r\n    if (!replayButton) {\r\n      replayButton = document.createElement('button');\r\n      replayButton.setAttribute('id', 'replayButton');\r\n      replayButton.classList.add('mdl-button', 'mdl-js-button',\r\n          'mdl-button--raised', 'mdl-js-ripple-effect',\r\n          'mdl-button--accent', 'cursorPointer');\r\n      replayButton.innerText = 'Play Again!';\r\n      gamesDialog.firstChild.appendChild(replayButton);\r\n      replayButton.addEventListener('click', replayOpponent);\r\n    }\r\n    if (game.difficulty === 'medium') {\r\n      radioEasy.removeAttribute('checked');\r\n      radioHard.removeAttribute('checked');\r\n      radioMed.setAttribute('checked', true);\r\n    } else if (game.difficulty === 'hard') {\r\n      radioEasy.removeAttribute('checked');\r\n      radioMed.removeAttribute('checked');\r\n      radioHard.setAttribute('checked', true);\r\n    } else {\r\n      radioMed.removeAttribute('checked');\r\n      radioHard.removeAttribute('checked');\r\n      radioEasy.setAttribute('checked', true);\r\n    }\r\n    if (!gamesDialog.open) gamesDialog.showModal();\r\n\r\n    /** Load game based on user selection */\r\n    function replayOpponent() {\r\n      let difficulty =\r\n        radioMed.parentElement.classList.contains('is-checked') ?\r\n          'medium' : 'easy';\r\n      difficulty =\r\n        radioHard.parentElement.classList.contains('is-checked') ?\r\n          'hard' : difficulty;\r\n      const they = currentUser.uid === game.initiator.uid ?\r\n        'opponent' : 'initiator';\r\n      closeGamesDialog();\r\n\r\n      // load puzzle based on uids of players\r\n      window.puzzleWorker.loadPuzzle({\r\n        initiator: {\r\n          uid: currentUser.uid,\r\n          displayName: currentUser.displayName,\r\n        },\r\n        opponent: {\r\n          uid: game[they].uid,\r\n          displayName: game[they].displayName,\r\n        },\r\n        difficulty: difficulty,\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load game based on user selection\r\n   * @param {Object} event Click event from dialogListContainer\r\n   */\r\n  function loadActiveGame(event) {\r\n    const target = event.target.parentElement;\r\n    if (target.id === '') {\r\n      window.puzzleWorker.fetchPuzzle(target.parentElement.id);\r\n    } else {\r\n      window.puzzleWorker.fetchPuzzle(target.id);\r\n    }\r\n    // if (event.target.nodeName.toLowerCase() !== 'span' ||\r\n    //   event.target.id === '') return;\r\n    // window.puzzleWorker.fetchPuzzle(event.target.parentElement.id);\r\n    // unsubscribe();\r\n    // location.hash = '#puzzle';\r\n  }\r\n\r\n  /** Clear lists on games view */\r\n  function clearLists() {\r\n    activeGamesContainer.innerHTML =\r\n      'You must sign in to see your active games';\r\n    pastGamesContainer.innerHTML =\r\n      'You must sign in to see your completed games';\r\n    window.puzzleWorker.clearPuzzle();\r\n  }\r\n\r\n  /** Init in case we need it */\r\n  function init() {\r\n    console.log('puzzleWorker here!');\r\n  }\r\n\r\n  return {\r\n    // initPicker: initPicker,\r\n    init: init,\r\n    subscribe: subscribe,\r\n    unsubscribe: unsubscribe,\r\n    clearLists: clearLists,\r\n    showReplayDialog: showReplayDialog,\r\n  };\r\n})(document, window);\r\n\r\npuzzleGames.subscribe();\r\n","/* eslint-env es6, browser */\r\n(function(document, window) {\r\n  window.addEventListener('load', function() {\r\n    initApp();\r\n  });\r\n\r\n  /** Initialize after document loads */\r\n  function initApp() {\r\n    const querySelector = document.querySelector.bind(document);\r\n    const appContainer = querySelector('#appContainer');\r\n    const gamesPanel = querySelector('#gamesPanel');\r\n    const gamesDialog = querySelector('#gamesDialog');\r\n    const scores = querySelector('#scores');\r\n    const concessionBtnContainer = querySelector('#concessionBtnContainer');\r\n    const puzAuthor = querySelector('#puzAuthor');\r\n    const puzCopy = querySelector('#puzCopy');\r\n\r\n    window.addEventListener('hashchange', navigate);\r\n\r\n    /**\r\n     * Navigate based on hash change\r\n     */\r\n    function navigate() {\r\n      if (location.hash === '#puzzle') {\r\n        try {\r\n          const replayButton = querySelector('#replayButton');\r\n          if (!replayButton) {\r\n            gamesDialog.close();\r\n          }\r\n        } catch (err) {\r\n          // do nothing, error OK\r\n        }\r\n        window.puzzleGames.unsubscribe();\r\n        gamesPanel.classList.add('slideOut');\r\n        appContainer.classList.add('slideIn');\r\n        concessionBtnContainer.classList.remove('displayNone');\r\n        puzAuthor.classList.remove('displayNone');\r\n        puzCopy.classList.remove('displayNone');\r\n      } else if (location.hash === '#signin') {\r\n        window.puzzleGames.unsubscribe();\r\n        gamesPanel.classList.add('slideOut');\r\n        appContainer.classList.add('slideIn');\r\n        scores.classList.remove('displayFlex');\r\n        scores.classList.add('displayNone');\r\n        concessionBtnContainer.classList.remove('displayNone');\r\n        puzAuthor.classList.add('displayNone');\r\n        puzCopy.classList.add('displayNone');\r\n      } else if (location.hash === '#games') {\r\n        try {\r\n          gamesDialog.close();\r\n        } catch (err) {\r\n          // do nothing, error OK\r\n        }\r\n        window.puzzleGames.subscribe();\r\n        gamesPanel.classList.remove('slideOut');\r\n        appContainer.classList.remove('slideIn');\r\n        scores.classList.remove('displayFlex');\r\n        scores.classList.add('displayNone');\r\n        puzAuthor.classList.add('displayNone');\r\n        puzCopy.classList.add('displayNone');\r\n      }\r\n    }\r\n\r\n    if (location.hash !== '#games') {\r\n      location.hash = '#games';\r\n    }\r\n  }\r\n})(document, window);\r\n"]}